commit 709cc0434514d7bd243ce96bc9744584a9b29ff4
Author:     Dmitry Fleytman <dmitry@daynix.com>
AuthorDate: Fri Apr 4 12:45:21 2014 +0300
Commit:     Michael Roth <mdroth@linux.vnet.ibm.com>
CommitDate: Wed Jun 25 17:13:33 2014 -0500

    vmxnet3: validate interrupt indices read on migration
    
    CVE-2013-4544
    
    Signed-off-by: Dmitry Fleytman <dmitry@daynix.com>
    Reported-by: Michael S. Tsirkin <mst@redhat.com>
    Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
    Reviewed-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
    Message-id: 1396604722-11902-4-git-send-email-dmitry@daynix.com
    Signed-off-by: Peter Maydell <peter.maydell@linaro.org>
    (cherry picked from commit 3c99afc779c2c78718a565ad8c5e98de7c2c7484)
    Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>

diff --git a/hw/net/vmxnet3.c b/hw/net/vmxnet3.c
index 0dd8c7adc7..b9ed47ad77 100644
--- a/hw/net/vmxnet3.c
+++ b/hw/net/vmxnet3.c
@@ -2393,6 +2393,8 @@ static int vmxnet3_post_load(void *opaque, int version_id)
         }
     }
 
+    vmxnet3_validate_interrupts(s);
+
     return 0;
 }
 
