--- CVE-2017-9503_1.9_CWE-476_87e459a810d7b1ec1638085b5a80ea3d9b43119a_megasas.c_29_OLD.vul	2020-05-20 08:42:08.326716384 -0400
+++ CVE-2017-9503_1.9_CWE-476_87e459a810d7b1ec1638085b5a80ea3d9b43119a_megasas.c_29_NEW.vul	2020-05-20 08:42:08.326716384 -0400
@@ -1,6 +1,9 @@
 static void megasas_abort_command(MegasasCmd *cmd)
 {
     /* Never abort internal commands.  */
+    if (cmd->dcmd_opcode != -1) {
+        return;
+    }
     if (cmd->req != NULL) {
         scsi_req_cancel(cmd->req);
     }
