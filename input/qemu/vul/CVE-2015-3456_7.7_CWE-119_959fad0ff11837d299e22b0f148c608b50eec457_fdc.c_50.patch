--- CVE-2015-3456_7.7_CWE-119_959fad0ff11837d299e22b0f148c608b50eec457_fdc.c_50_OLD.vul	2020-05-20 08:45:34.779033884 -0400
+++ CVE-2015-3456_7.7_CWE-119_959fad0ff11837d299e22b0f148c608b50eec457_fdc.c_50_NEW.vul	2020-05-20 08:45:34.779033884 -0400
@@ -2,7 +2,7 @@
 {
     FDrive *cur_drv;
     uint32_t retval = 0;
-    int pos;
+    uint32_t pos;
 
     cur_drv = get_cur_drv(fdctrl);
     fdctrl->dsr &= ~FD_DSR_PWRDOWN;
@@ -11,8 +11,8 @@
         return 0;
     }
     pos = fdctrl->data_pos;
+    pos %= FD_SECTOR_LEN;
     if (fdctrl->msr & FD_MSR_NONDMA) {
-        pos %= FD_SECTOR_LEN;
         if (pos == 0) {
             if (fdctrl->data_pos != 0)
                 if (!fdctrl_seek_to_next_sect(fdctrl, cur_drv)) {
