--- CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_20_OLD.vul	2020-05-20 08:44:37.241175023 -0400
+++ CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_20_NEW.vul	2020-05-20 08:44:37.241175023 -0400
@@ -6,6 +6,8 @@
         return -ENOMEDIUM;
     if (bs->read_only)
         return -EACCES;
+    if (bdrv_wr_badreq_sectors(bs, sector_num, nb_sectors))
+        return -EDOM;
     if (sector_num == 0 && bs->boot_sector_enabled && nb_sectors > 0) {
         memcpy(bs->boot_sector_data, buf, 512);
     }
