--- CVE-2016-4952_1.5_CWE-125_3e831b40e015ba34dfb55ff11f767001839425ff_vmw_pvscsi.c_40_OLD.vul	2020-05-20 08:42:14.098501613 -0400
+++ CVE-2016-4952_1.5_CWE-125_3e831b40e015ba34dfb55ff11f767001839425ff_vmw_pvscsi.c_40_NEW.vul	2020-05-20 08:42:14.098501613 -0400
@@ -7,7 +7,10 @@
     trace_pvscsi_on_cmd_arrived("PVSCSI_CMD_SETUP_RINGS");
 
     pvscsi_dbg_dump_tx_rings_config(rc);
-    pvscsi_ring_init_data(&s->rings, rc);
+    if (pvscsi_ring_init_data(&s->rings, rc) < 0) {
+        return PVSCSI_COMMAND_PROCESSING_FAILED;
+    }
+
     s->rings_info_valid = TRUE;
     return PVSCSI_COMMAND_PROCESSING_SUCCEEDED;
 }
