--- CVE-2007-1320_7.2_CWE-119_b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef_cirrus_vga.c_13_OLD.vul	2020-05-20 08:34:04.288372428 -0400
+++ CVE-2007-1320_7.2_CWE-119_b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef_cirrus_vga.c_13_NEW.vul	2020-05-20 08:34:04.288372428 -0400
@@ -45,8 +45,10 @@
     if (notify)
 	vga_hw_update();
 
-    (*s->cirrus_rop) (s, s->vram_ptr + s->cirrus_blt_dstaddr,
-		      s->vram_ptr + s->cirrus_blt_srcaddr,
+    (*s->cirrus_rop) (s, s->vram_ptr +
+		      (s->cirrus_blt_dstaddr & s->cirrus_addr_mask),
+		      s->vram_ptr +
+		      (s->cirrus_blt_srcaddr & s->cirrus_addr_mask),
 		      s->cirrus_blt_dstpitch, s->cirrus_blt_srcpitch,
 		      s->cirrus_blt_width, s->cirrus_blt_height);
 
