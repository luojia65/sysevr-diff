--- CVE-2017-7471_7.7_CWE-732_96bae145e27d4df62671b4eebd6c735f412016cf_9p-local.c_41_OLD.vul	2020-05-20 08:33:28.233441598 -0400
+++ CVE-2017-7471_7.7_CWE-732_96bae145e27d4df62671b4eebd6c735f412016cf_9p-local.c_41_NEW.vul	2020-05-20 08:33:28.233441598 -0400
@@ -3,8 +3,13 @@
 {
     if (dir_path) {
         v9fs_path_sprintf(target, "%s/%s", dir_path->data, name);
-    } else {
+    } else if (strcmp(name, "/")) {
         v9fs_path_sprintf(target, "%s", name);
+    } else {
+        /* We want the path of the export root to be relative, otherwise
+         * "*at()" syscalls would treat it as "/" in the host.
+         */
+        v9fs_path_sprintf(target, "%s", ".");
     }
     return 0;
 }
