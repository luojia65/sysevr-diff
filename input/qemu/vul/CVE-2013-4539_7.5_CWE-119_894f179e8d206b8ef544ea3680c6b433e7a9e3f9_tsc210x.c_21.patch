--- CVE-2013-4539_7.5_CWE-119_894f179e8d206b8ef544ea3680c6b433e7a9e3f9_tsc210x.c_21_OLD.vul	2020-05-20 08:43:46.043080218 -0400
+++ CVE-2013-4539_7.5_CWE-119_894f179e8d206b8ef544ea3680c6b433e7a9e3f9_tsc210x.c_21_NEW.vul	2020-05-20 08:43:46.043080218 -0400
@@ -20,9 +20,21 @@
     s->enabled = qemu_get_byte(f);
     s->host_mode = qemu_get_byte(f);
     s->function = qemu_get_byte(f);
+    if (s->function < 0 || s->function >= ARRAY_SIZE(mode_regs)) {
+        return -EINVAL;
+    }
     s->nextfunction = qemu_get_byte(f);
+    if (s->nextfunction < 0 || s->nextfunction >= ARRAY_SIZE(mode_regs)) {
+        return -EINVAL;
+    }
     s->precision = qemu_get_byte(f);
+    if (s->precision < 0 || s->precision >= ARRAY_SIZE(resolution)) {
+        return -EINVAL;
+    }
     s->nextprecision = qemu_get_byte(f);
+    if (s->nextprecision < 0 || s->nextprecision >= ARRAY_SIZE(resolution)) {
+        return -EINVAL;
+    }
     s->filter = qemu_get_byte(f);
     s->pin_func = qemu_get_byte(f);
     s->ref = qemu_get_byte(f);
