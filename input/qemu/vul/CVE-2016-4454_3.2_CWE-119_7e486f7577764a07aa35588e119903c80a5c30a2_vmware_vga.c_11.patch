--- CVE-2016-4454_3.2_CWE-119_7e486f7577764a07aa35588e119903c80a5c30a2_vmware_vga.c_11_OLD.vul	2020-05-20 08:45:24.499416423 -0400
+++ CVE-2016-4454_3.2_CWE-119_7e486f7577764a07aa35588e119903c80a5c30a2_vmware_vga.c_11_NEW.vul	2020-05-20 08:45:24.499416423 -0400
@@ -9,7 +9,7 @@
     len = vmsvga_fifo_length(s);
     while (len > 0) {
         /* May need to go back to the start of the command if incomplete */
-        cmd_start = s->cmd->stop;
+        cmd_start = s->fifo_stop;
 
         switch (cmd = vmsvga_fifo_read(s)) {
         case SVGA_CMD_UPDATE:
@@ -168,7 +168,8 @@
             break;
 
         rewind:
-            s->cmd->stop = cmd_start;
+            s->fifo_stop = cmd_start;
+            s->fifo[SVGA_FIFO_STOP] = cpu_to_le32(s->fifo_stop);
             break;
         }
     }
