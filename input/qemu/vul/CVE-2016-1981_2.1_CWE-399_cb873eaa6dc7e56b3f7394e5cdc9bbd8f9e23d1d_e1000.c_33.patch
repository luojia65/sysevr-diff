--- CVE-2016-1981_2.1_CWE-399_cb873eaa6dc7e56b3f7394e5cdc9bbd8f9e23d1d_e1000.c_33_OLD.vul	2020-05-20 08:37:18.709477325 -0400
+++ CVE-2016-1981_2.1_CWE-399_cb873eaa6dc7e56b3f7394e5cdc9bbd8f9e23d1d_e1000.c_33_NEW.vul	2020-05-20 08:37:18.709477325 -0400
@@ -30,7 +30,8 @@
          * bogus values to TDT/TDLEN.
          * there's nothing too intelligent we could do about this.
          */
-        if (s->mac_reg[TDH] == tdh_start) {
+        if (s->mac_reg[TDH] == tdh_start ||
+            tdh_start >= s->mac_reg[TDLEN] / sizeof(desc)) {
             DBGOUT(TXERR, "TDH wraparound @%x, TDT %x, TDLEN %x\n",
                    tdh_start, s->mac_reg[TDT], s->mac_reg[TDLEN]);
             break;
