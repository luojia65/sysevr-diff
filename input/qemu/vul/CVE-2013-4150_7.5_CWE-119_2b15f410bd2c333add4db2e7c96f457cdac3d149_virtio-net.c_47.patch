--- CVE-2013-4150_7.5_CWE-119_2b15f410bd2c333add4db2e7c96f457cdac3d149_virtio-net.c_47_OLD.vul	2020-05-20 08:43:06.500551680 -0400
+++ CVE-2013-4150_7.5_CWE-119_2b15f410bd2c333add4db2e7c96f457cdac3d149_virtio-net.c_47_NEW.vul	2020-05-20 08:43:06.504551533 -0400
@@ -81,6 +81,11 @@
         }
 
         n->curr_queues = qemu_get_be16(f);
+        if (n->curr_queues > n->max_queues) {
+            error_report("virtio-net: curr_queues %x > max_queues %x",
+                         n->curr_queues, n->max_queues);
+            return -1;
+        }
         for (i = 1; i < n->curr_queues; i++) {
             n->vqs[i].tx_waiting = qemu_get_be32(f);
         }
