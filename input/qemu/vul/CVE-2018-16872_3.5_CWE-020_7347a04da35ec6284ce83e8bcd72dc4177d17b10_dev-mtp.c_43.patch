--- CVE-2018-16872_3.5_CWE-020_7347a04da35ec6284ce83e8bcd72dc4177d17b10_dev-mtp.c_43_OLD.vul	2020-05-20 08:50:37.227778948 -0400
+++ CVE-2018-16872_3.5_CWE-020_7347a04da35ec6284ce83e8bcd72dc4177d17b10_dev-mtp.c_43_NEW.vul	2020-05-20 08:50:37.227778948 -0400
@@ -26,7 +26,7 @@
                                  0, 0, 0, 0);
             goto done;
         }
-        d->fd = open(path, O_CREAT | O_WRONLY, mask);
+        d->fd = open(path, O_CREAT | O_WRONLY | O_CLOEXEC | O_NOFOLLOW, mask);
         if (d->fd == -1) {
             usb_mtp_queue_result(s, RES_STORE_FULL, d->trans,
                                  0, 0, 0, 0);
