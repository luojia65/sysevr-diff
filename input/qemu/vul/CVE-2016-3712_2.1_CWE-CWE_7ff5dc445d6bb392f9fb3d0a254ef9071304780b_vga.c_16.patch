--- CVE-2016-3712_2.1_CWE-CWE_7ff5dc445d6bb392f9fb3d0a254ef9071304780b_vga.c_16_OLD.vul	2020-05-20 08:45:21.639522846 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_7ff5dc445d6bb392f9fb3d0a254ef9071304780b_vga.c_16_NEW.vul	2020-05-20 08:45:21.639522846 -0400
@@ -27,7 +27,7 @@
         break;
     }
 
-    if (s->sr[VGA_SEQ_MEMORY_MODE] & VGA_SR04_CHN_4M) {
+    if (sr(s, VGA_SEQ_MEMORY_MODE) & VGA_SR04_CHN_4M) {
         /* chain 4 mode : simplest access */
         assert(addr < s->vram_size);
         ret = s->vram_ptr[addr];
