--- CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_36_OLD.vul	2020-05-20 08:31:57.679658606 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_36_NEW.vul	2020-05-20 08:31:57.679658606 -0400
@@ -32,10 +32,10 @@
         /* total width & height */
         cheight = (s->cr[VGA_CRTC_MAX_SCAN] & 0x1f) + 1;
         cw = 8;
-        if (!(s->sr[VGA_SEQ_CLOCK_MODE] & VGA_SR01_CHAR_CLK_8DOTS)) {
+        if (!(sr(s, VGA_SEQ_CLOCK_MODE) & VGA_SR01_CHAR_CLK_8DOTS)) {
             cw = 9;
         }
-        if (s->sr[VGA_SEQ_CLOCK_MODE] & 0x08) {
+        if (sr(s, VGA_SEQ_CLOCK_MODE) & 0x08) {
             cw = 16; /* NOTE: no 18 pixel wide */
         }
         width = (s->cr[VGA_CRTC_H_DISP] + 1);
