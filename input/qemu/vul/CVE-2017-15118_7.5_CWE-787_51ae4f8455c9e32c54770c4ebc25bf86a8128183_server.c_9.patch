--- CVE-2017-15118_7.5_CWE-787_51ae4f8455c9e32c54770c4ebc25bf86a8128183_server.c_9_OLD.vul	2020-05-20 08:47:25.666907452 -0400
+++ CVE-2017-15118_7.5_CWE-787_51ae4f8455c9e32c54770c4ebc25bf86a8128183_server.c_9_NEW.vul	2020-05-20 08:47:25.666907452 -0400
@@ -33,6 +33,10 @@
         msg = "name length is incorrect";
         goto invalid;
     }
+    if (namelen >= sizeof(name)) {
+        msg = "name too long for qemu";
+        goto invalid;
+    }
     if (nbd_read(client->ioc, name, namelen, errp) < 0) {
         return -EIO;
     }
