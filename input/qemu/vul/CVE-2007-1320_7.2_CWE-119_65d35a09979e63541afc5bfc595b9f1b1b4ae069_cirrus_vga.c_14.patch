--- CVE-2007-1320_7.2_CWE-119_65d35a09979e63541afc5bfc595b9f1b1b4ae069_cirrus_vga.c_14_OLD.vul	2020-05-20 08:49:07.403121580 -0400
+++ CVE-2007-1320_7.2_CWE-119_65d35a09979e63541afc5bfc595b9f1b1b4ae069_cirrus_vga.c_14_NEW.vul	2020-05-20 08:49:07.403121580 -0400
@@ -1,14 +1,13 @@
 static int cirrus_bitblt_videotovideo_copy(CirrusVGAState * s)
 {
+    if (BLTUNSAFE(s))
+        return 0;
+
     if (s->ds->dpy_copy) {
 	cirrus_do_copy(s, s->cirrus_blt_dstaddr - s->start_addr,
 		       s->cirrus_blt_srcaddr - s->start_addr,
 		       s->cirrus_blt_width, s->cirrus_blt_height);
     } else {
-
-    if (BLTUNSAFE(s))
-        return 0;
-
 	(*s->cirrus_rop) (s, s->vram_ptr +
                 (s->cirrus_blt_dstaddr & s->cirrus_addr_mask),
 			  s->vram_ptr +
