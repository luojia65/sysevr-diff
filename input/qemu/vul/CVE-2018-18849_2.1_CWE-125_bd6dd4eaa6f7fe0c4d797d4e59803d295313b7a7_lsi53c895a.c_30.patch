--- CVE-2018-18849_2.1_CWE-125_bd6dd4eaa6f7fe0c4d797d4e59803d295313b7a7_lsi53c895a.c_30_OLD.vul	2020-05-20 08:45:27.835292284 -0400
+++ CVE-2018-18849_2.1_CWE-125_bd6dd4eaa6f7fe0c4d797d4e59803d295313b7a7_lsi53c895a.c_30_NEW.vul	2020-05-20 08:45:27.835292284 -0400
@@ -1,9 +1,10 @@
 static void lsi_do_msgin(LSIState *s)
 {
-    int len;
+    uint8_t len;
     DPRINTF("Message in len=%d/%d\n", s->dbc, s->msg_len);
     s->sfbr = s->msg[0];
     len = s->msg_len;
+    assert(len > 0 && len <= LSI_MAX_MSGIN_LEN);
     if (len > s->dbc)
         len = s->dbc;
     pci_dma_write(PCI_DEVICE(s), s->dnad, s->msg, len);
