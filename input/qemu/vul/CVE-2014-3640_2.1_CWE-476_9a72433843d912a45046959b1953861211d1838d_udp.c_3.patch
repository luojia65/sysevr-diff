--- CVE-2014-3640_2.1_CWE-476_9a72433843d912a45046959b1953861211d1838d_udp.c_3_OLD.vul	2020-05-20 08:45:02.160247719 -0400
+++ CVE-2014-3640_2.1_CWE-476_9a72433843d912a45046959b1953861211d1838d_udp.c_3_NEW.vul	2020-05-20 08:45:02.160247719 -0400
@@ -89,7 +89,7 @@
 	 * Locate pcb for datagram.
 	 */
 	so = slirp->udp_last_so;
-	if (so->so_lport != uh->uh_sport ||
+	if (so == &slirp->udb || so->so_lport != uh->uh_sport ||
 	    so->so_laddr.s_addr != ip->ip_src.s_addr) {
 		struct socket *tmp;
 
