--- CVE-2016-4453_4.6_CWE-399_d59d37dea4fa8ae716409a828f5ba117ce597da6_vmware_vga.c_11_OLD.vul	2020-05-20 08:41:01.265211605 -0400
+++ CVE-2016-4453_4.6_CWE-399_d59d37dea4fa8ae716409a828f5ba117ce597da6_vmware_vga.c_11_NEW.vul	2020-05-20 08:41:01.265211605 -0400
@@ -1,13 +1,13 @@
 static void vmsvga_fifo_run(struct vmsvga_state_s *s)
 {
     uint32_t cmd, colour;
-    int args, len;
+    int args, len, maxloop = 1024;
     int x, y, dx, dy, width, height;
     struct vmsvga_cursor_definition_s cursor;
     uint32_t cmd_start;
 
     len = vmsvga_fifo_length(s);
-    while (len > 0) {
+    while (len > 0 && --maxloop > 0) {
         /* May need to go back to the start of the command if incomplete */
         cmd_start = s->fifo_stop;
 
