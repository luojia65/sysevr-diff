--- CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_23_OLD.vul	2020-05-20 08:44:37.137178892 -0400
+++ CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_23_NEW.vul	2020-05-20 08:44:37.137178892 -0400
@@ -7,5 +7,7 @@
         return -ENOMEDIUM;
     if (!drv->bdrv_pread)
         return bdrv_pread_em(bs, offset, buf1, count1);
+    if (bdrv_rd_badreq_bytes(bs, offset, count1))
+        return -EDOM;
     return drv->bdrv_pread(bs, offset, buf1, count1);
 }
