--- CVE-2015-8558_4.9_CWE-020_156a2e4dbffa85997636a7a39ef12da6f1b40254_hcd-ehci.c_63_OLD.vul	2020-05-20 08:32:55.974324731 -0400
+++ CVE-2015-8558_4.9_CWE-020_156a2e4dbffa85997636a7a39ef12da6f1b40254_hcd-ehci.c_63_NEW.vul	2020-05-20 08:32:55.974324731 -0400
@@ -4,7 +4,7 @@
 {
     USBDevice *dev;
     USBEndpoint *ep;
-    uint32_t i, len, pid, dir, devaddr, endp;
+    uint32_t i, len, pid, dir, devaddr, endp, xfers = 0;
     uint32_t pg, off, ptr1, ptr2, max, mult;
 
     ehci->periodic_sched_active = PERIODIC_ACTIVE;
@@ -94,7 +94,8 @@
                 ehci_raise_irq(ehci, USBSTS_INT);
             }
             itd->transact[i] &= ~ITD_XACT_ACTIVE;
+            xfers++;
         }
     }
-    return 0;
+    return xfers ? 0 : -1;
 }
