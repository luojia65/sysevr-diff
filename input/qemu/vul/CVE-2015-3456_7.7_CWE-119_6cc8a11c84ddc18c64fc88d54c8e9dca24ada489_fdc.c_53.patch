--- CVE-2015-3456_7.7_CWE-119_6cc8a11c84ddc18c64fc88d54c8e9dca24ada489_fdc.c_53_OLD.vul	2020-05-20 08:47:17.015229399 -0400
+++ CVE-2015-3456_7.7_CWE-119_6cc8a11c84ddc18c64fc88d54c8e9dca24ada489_fdc.c_53_NEW.vul	2020-05-20 08:47:17.015229399 -0400
@@ -37,6 +37,7 @@
         }
 
         if (++fdctrl->data_pos == fdctrl->data_len) {
+            fdctrl->msr &= ~FD_MSR_RQM;
             fdctrl_stop_transfer(fdctrl, 0x00, 0x00, 0x00);
         }
         break;
@@ -44,6 +45,7 @@
     case FD_PHASE_RESULT:
         assert(!(fdctrl->msr & FD_MSR_NONDMA));
         if (++fdctrl->data_pos == fdctrl->data_len) {
+            fdctrl->msr &= ~FD_MSR_RQM;
             fdctrl_to_command_phase(fdctrl);
             fdctrl_reset_irq(fdctrl);
         }
