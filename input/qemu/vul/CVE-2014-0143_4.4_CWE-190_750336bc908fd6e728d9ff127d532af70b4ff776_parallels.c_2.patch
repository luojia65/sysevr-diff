--- CVE-2014-0143_4.4_CWE-190_750336bc908fd6e728d9ff127d532af70b4ff776_parallels.c_2_OLD.vul	2020-05-20 08:39:41.492178917 -0400
+++ CVE-2014-0143_4.4_CWE-190_750336bc908fd6e728d9ff127d532af70b4ff776_parallels.c_2_NEW.vul	2020-05-20 08:39:41.492178917 -0400
@@ -24,6 +24,11 @@
     s->tracks = le32_to_cpu(ph.tracks);
 
     s->catalog_size = le32_to_cpu(ph.catalog_entries);
+    if (s->catalog_size > INT_MAX / 4) {
+        error_setg(errp, "Catalog too large");
+        ret = -EFBIG;
+        goto fail;
+    }
     s->catalog_bitmap = g_malloc(s->catalog_size * 4);
 
     ret = bdrv_pread(bs->file, 64, s->catalog_bitmap, s->catalog_size * 4);
