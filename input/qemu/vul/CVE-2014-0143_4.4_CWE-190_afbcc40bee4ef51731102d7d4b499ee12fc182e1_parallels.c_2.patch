--- CVE-2014-0143_4.4_CWE-190_afbcc40bee4ef51731102d7d4b499ee12fc182e1_parallels.c_2_OLD.vul	2020-05-20 08:34:30.987501270 -0400
+++ CVE-2014-0143_4.4_CWE-190_afbcc40bee4ef51731102d7d4b499ee12fc182e1_parallels.c_2_NEW.vul	2020-05-20 08:34:30.987501270 -0400
@@ -25,6 +25,11 @@
     s->tracks = le32_to_cpu(ph.tracks);
 
     s->catalog_size = le32_to_cpu(ph.catalog_entries);
+    if (s->catalog_size > INT_MAX / 4) {
+        error_setg(errp, "Catalog too large");
+        ret = -EFBIG;
+        goto fail;
+    }
     s->catalog_bitmap = g_malloc(s->catalog_size * 4);
 
     ret = bdrv_pread(bs->file, 64, s->catalog_bitmap, s->catalog_size * 4);
