--- CVE-2018-16872_3.5_CWE-020_7347a04da35ec6284ce83e8bcd72dc4177d17b10_dev-mtp.c_31_OLD.vul	2020-05-20 08:50:37.211779543 -0400
+++ CVE-2018-16872_3.5_CWE-020_7347a04da35ec6284ce83e8bcd72dc4177d17b10_dev-mtp.c_31_NEW.vul	2020-05-20 08:50:37.211779543 -0400
@@ -11,7 +11,7 @@
                                         c->argv[1], c->argv[2]);
 
     d = usb_mtp_data_alloc(c);
-    d->fd = open(o->path, O_RDONLY);
+    d->fd = open(o->path, O_RDONLY | O_CLOEXEC | O_NOFOLLOW);
     if (d->fd == -1) {
         usb_mtp_data_free(d);
         return NULL;
