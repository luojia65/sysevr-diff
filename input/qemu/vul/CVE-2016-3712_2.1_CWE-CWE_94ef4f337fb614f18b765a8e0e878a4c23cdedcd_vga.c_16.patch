--- CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_16_OLD.vul	2020-05-20 08:31:57.719658470 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_16_NEW.vul	2020-05-20 08:31:57.719658470 -0400
@@ -27,7 +27,7 @@
         break;
     }
 
-    if (s->sr[VGA_SEQ_MEMORY_MODE] & VGA_SR04_CHN_4M) {
+    if (sr(s, VGA_SEQ_MEMORY_MODE) & VGA_SR04_CHN_4M) {
         /* chain 4 mode : simplest access */
         assert(addr < s->vram_size);
         ret = s->vram_ptr[addr];
