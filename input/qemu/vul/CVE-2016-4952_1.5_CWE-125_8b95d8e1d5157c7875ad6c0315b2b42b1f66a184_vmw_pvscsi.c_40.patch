--- CVE-2016-4952_1.5_CWE-125_8b95d8e1d5157c7875ad6c0315b2b42b1f66a184_vmw_pvscsi.c_40_OLD.vul	2020-05-20 08:37:15.817584163 -0400
+++ CVE-2016-4952_1.5_CWE-125_8b95d8e1d5157c7875ad6c0315b2b42b1f66a184_vmw_pvscsi.c_40_NEW.vul	2020-05-20 08:37:15.821584016 -0400
@@ -7,7 +7,10 @@
     trace_pvscsi_on_cmd_arrived("PVSCSI_CMD_SETUP_RINGS");
 
     pvscsi_dbg_dump_tx_rings_config(rc);
-    pvscsi_ring_init_data(&s->rings, rc);
+    if (pvscsi_ring_init_data(&s->rings, rc) < 0) {
+        return PVSCSI_COMMAND_PROCESSING_FAILED;
+    }
+
     s->rings_info_valid = TRUE;
     return PVSCSI_COMMAND_PROCESSING_SUCCEEDED;
 }
