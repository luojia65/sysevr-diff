--- CVE-2016-9602_9.0_CWE-059_72f0d0bf51362011c4d841a89fb8f5cfb16e0bf3_9p-posix-acl.c_8_OLD.vul	2020-05-20 08:48:09.945259743 -0400
+++ CVE-2016-9602_9.0_CWE-059_72f0d0bf51362011c4d841a89fb8f5cfb16e0bf3_9p-posix-acl.c_8_NEW.vul	2020-05-20 08:48:09.945259743 -0400
@@ -2,10 +2,8 @@
                                const char *path, const char *name)
 {
     int ret;
-    char *buffer;
 
-    buffer = rpath(ctx, path);
-    ret  = lremovexattr(buffer, MAP_ACL_DEFAULT);
+    ret = local_removexattr_nofollow(ctx, path, MAP_ACL_DEFAULT);
     if (ret == -1 && errno == ENODATA) {
         /*
          * We don't get ENODATA error when trying to remove a
@@ -15,6 +13,5 @@
         errno = 0;
         ret = 0;
     }
-    g_free(buffer);
     return ret;
 }
