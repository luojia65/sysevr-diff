--- CVE-2014-0144_0.0_CWE-000_04bc6981ca7ea65d9d4e61b4758dcb9336fd045d_qcow2-snapshot.c_7_OLD.vul	2020-05-20 08:45:37.186944279 -0400
+++ CVE-2014-0144_0.0_CWE-000_04bc6981ca7ea65d9d4e61b4758dcb9336fd045d_qcow2-snapshot.c_7_NEW.vul	2020-05-20 08:45:37.186944279 -0400
@@ -8,6 +8,10 @@
     uint64_t *l1_table = NULL;
     int64_t l1_table_offset;
 
+    if (s->nb_snapshots >= QCOW_MAX_SNAPSHOTS) {
+        return -EFBIG;
+    }
+
     memset(sn, 0, sizeof(*sn));
 
     /* Generate an ID if it wasn't passed */
