--- CVE-2018-5683_2.1_CWE-125_191f59dc17396bb5a8da50f8c59b6e0a430711a4_vga.c_24_OLD.vul	2020-05-20 08:33:37.417184550 -0400
+++ CVE-2018-5683_2.1_CWE-125_191f59dc17396bb5a8da50f8c59b6e0a430711a4_vga.c_24_NEW.vul	2020-05-20 08:33:37.417184550 -0400
@@ -104,6 +104,9 @@
         cx_min = width;
         cx_max = -1;
         for(cx = 0; cx < width; cx++) {
+            if (src + sizeof(uint16_t) > s->vram_ptr + s->vram_size) {
+                break;
+            }
             ch_attr = *(uint16_t *)src;
             if (full_update || ch_attr != *ch_attr_ptr || src == cursor_ptr) {
                 if (cx < cx_min)
