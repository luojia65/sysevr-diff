--- CVE-2017-15124_7.8_CWE-020_f9c8767828aa44441681ea683f53cef8135050cd_vnc.c_36_OLD.vul	2020-05-20 08:47:02.031786970 -0400
+++ CVE-2017-15124_7.8_CWE-020_f9c8767828aa44441681ea683f53cef8135050cd_vnc.c_36_NEW.vul	2020-05-20 08:47:02.035786820 -0400
@@ -4,10 +4,10 @@
     case VNC_STATE_UPDATE_NONE:
         break;
     case VNC_STATE_UPDATE_INCREMENTAL:
-        /* Only allow incremental updates if the output buffer
-         * is empty, or if audio capture is enabled.
+        /* Only allow incremental updates if the pending send queue
+         * is less than the permitted threshold
          */
-        if (!vs->output.offset || vs->audio_cap) {
+        if (vs->output.offset < vs->throttle_output_offset) {
             return true;
         }
         break;
