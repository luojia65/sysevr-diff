--- CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_58_OLD.vul	2020-05-20 08:44:37.161177999 -0400
+++ CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_58_NEW.vul	2020-05-20 08:44:37.161177999 -0400
@@ -7,6 +7,8 @@
 
     if (!drv)
         return NULL;
+    if (bdrv_rd_badreq_sectors(bs, sector_num, nb_sectors))
+        return NULL;
 
     /* XXX: we assume that nb_sectors == 0 is suppored by the async read */
     if (sector_num == 0 && bs->boot_sector_enabled && nb_sectors > 0) {
