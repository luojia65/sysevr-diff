--- CVE-2016-4952_1.5_CWE-125_3e831b40e015ba34dfb55ff11f767001839425ff_vmw_pvscsi.c_45_OLD.vul	2020-05-20 08:42:14.106501315 -0400
+++ CVE-2016-4952_1.5_CWE-125_3e831b40e015ba34dfb55ff11f767001839425ff_vmw_pvscsi.c_45_NEW.vul	2020-05-20 08:42:14.106501315 -0400
@@ -11,7 +11,9 @@
     }
 
     if (s->rings_info_valid) {
-        pvscsi_ring_init_msg(&s->rings, rc);
+        if (pvscsi_ring_init_msg(&s->rings, rc) < 0) {
+            return PVSCSI_COMMAND_PROCESSING_FAILED;
+        }
         s->msg_ring_info_valid = TRUE;
     }
     return sizeof(PVSCSICmdDescSetupMsgRing) / sizeof(uint32_t);
