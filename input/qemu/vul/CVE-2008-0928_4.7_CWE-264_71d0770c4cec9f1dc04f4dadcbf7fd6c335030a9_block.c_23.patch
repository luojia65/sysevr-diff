--- CVE-2008-0928_4.7_CWE-264_71d0770c4cec9f1dc04f4dadcbf7fd6c335030a9_block.c_23_OLD.vul	2020-05-20 08:47:28.658796114 -0400
+++ CVE-2008-0928_4.7_CWE-264_71d0770c4cec9f1dc04f4dadcbf7fd6c335030a9_block.c_23_NEW.vul	2020-05-20 08:47:28.658796114 -0400
@@ -5,6 +5,9 @@
 
     if (!drv)
         return -ENOMEDIUM;
+    if (bdrv_check_byte_request(bs, offset, count1))
+        return -EIO;
+
     if (!drv->bdrv_pread)
         return bdrv_pread_em(bs, offset, buf1, count1);
     return drv->bdrv_pread(bs, offset, buf1, count1);
