--- CVE-2017-15124_7.8_CWE-020_e2b72cb6e0443d90d7ab037858cb6834b6cca852_vnc.c_36_OLD.vul	2020-05-20 08:49:00.743369404 -0400
+++ CVE-2017-15124_7.8_CWE-020_e2b72cb6e0443d90d7ab037858cb6834b6cca852_vnc.c_36_NEW.vul	2020-05-20 08:49:00.743369404 -0400
@@ -4,10 +4,10 @@
     case VNC_STATE_UPDATE_NONE:
         break;
     case VNC_STATE_UPDATE_INCREMENTAL:
-        /* Only allow incremental updates if the output buffer
-         * is empty, or if audio capture is enabled.
+        /* Only allow incremental updates if the pending send queue
+         * is less than the permitted threshold
          */
-        if (!vs->output.offset || vs->audio_cap) {
+        if (vs->output.offset < vs->throttle_output_offset) {
             return true;
         }
         break;
