--- CVE-2008-0928_4.7_CWE-264_71d0770c4cec9f1dc04f4dadcbf7fd6c335030a9_block.c_64_OLD.vul	2020-05-20 08:47:28.718793882 -0400
+++ CVE-2008-0928_4.7_CWE-264_71d0770c4cec9f1dc04f4dadcbf7fd6c335030a9_block.c_64_NEW.vul	2020-05-20 08:47:28.718793882 -0400
@@ -2,6 +2,9 @@
                                   QEMUIOVector *iov, int nb_sectors,
                                   BlockDriverCompletionFunc *cb, void *opaque)
 {
+    if (bdrv_check_request(bs, sector_num, nb_sectors))
+        return NULL;
+
     return bdrv_aio_rw_vector(bs, sector_num, iov, nb_sectors,
                               cb, opaque, 1);
 }
