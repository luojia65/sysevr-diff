--- CVE-2015-8619_5.0_CWE-787_24fe899c3c9d5c4d2a156a26e08e905ab8e98384_input-legacy.c_1_OLD.vul	2020-05-20 08:34:47.602936873 -0400
+++ CVE-2015-8619_5.0_CWE-787_24fe899c3c9d5c4d2a156a26e08e905ab8e98384_input-legacy.c_1_NEW.vul	2020-05-20 08:34:47.606936735 -0400
@@ -1,9 +1,10 @@
-int index_from_key(const char *key)
+int index_from_key(const char *key, size_t key_length)
 {
     int i;
 
     for (i = 0; QKeyCode_lookup[i] != NULL; i++) {
-        if (!strcmp(key, QKeyCode_lookup[i])) {
+        if (!strncmp(key, QKeyCode_lookup[i], key_length) &&
+            !QKeyCode_lookup[i][key_length]) {
             break;
         }
     }
