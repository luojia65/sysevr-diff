--- CVE-2014-0142_2.1_CWE-369_76d1eddbe533d828eb866c36b7b13837986c7fc3_vpc.c_3_OLD.vul	2020-05-20 08:40:41.761937195 -0400
+++ CVE-2014-0142_2.1_CWE-369_76d1eddbe533d828eb866c36b7b13837986c7fc3_vpc.c_3_NEW.vul	2020-05-20 08:40:41.761937195 -0400
@@ -85,6 +85,11 @@
         }
 
         s->block_size = be32_to_cpu(dyndisk_header->block_size);
+        if (!is_power_of_2(s->block_size) || s->block_size < BDRV_SECTOR_SIZE) {
+            error_setg(errp, "Invalid block size %" PRIu32, s->block_size);
+            ret = -EINVAL;
+            goto fail;
+        }
         s->bitmap_size = ((s->block_size / (8 * 512)) + 511) & ~511;
 
         s->max_table_entries = be32_to_cpu(dyndisk_header->max_table_entries);
