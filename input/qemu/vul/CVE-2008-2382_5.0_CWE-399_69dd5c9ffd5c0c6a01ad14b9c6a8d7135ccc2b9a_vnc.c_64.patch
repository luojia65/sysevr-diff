--- CVE-2008-2382_5.0_CWE-399_69dd5c9ffd5c0c6a01ad14b9c6a8d7135ccc2b9a_vnc.c_64_OLD.vul	2020-05-20 08:41:06.893002224 -0400
+++ CVE-2008-2382_5.0_CWE-399_69dd5c9ffd5c0c6a01ad14b9c6a8d7135ccc2b9a_vnc.c_64_NEW.vul	2020-05-20 08:41:06.893002224 -0400
@@ -18,10 +18,13 @@
 	if (len == 1)
 	    return 4;
 
-	if (len == 4)
-	    return 4 + (read_u16(data, 2) * 4);
+	if (len == 4) {
+            limit = read_u16(data, 2);
+            if (limit > 0)
+                return 4 + (limit * 4);
+        } else
+            limit = read_u16(data, 2);
 
-	limit = read_u16(data, 2);
 	for (i = 0; i < limit; i++) {
 	    int32_t val = read_s32(data, 4 + (i * 4));
 	    memcpy(data + 4 + (i * 4), &val, sizeof(val));
