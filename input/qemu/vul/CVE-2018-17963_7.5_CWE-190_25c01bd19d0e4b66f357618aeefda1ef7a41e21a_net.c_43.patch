--- CVE-2018-17963_7.5_CWE-190_25c01bd19d0e4b66f357618aeefda1ef7a41e21a_net.c_43_OLD.vul	2020-05-20 08:48:18.152954311 -0400
+++ CVE-2018-17963_7.5_CWE-190_25c01bd19d0e4b66f357618aeefda1ef7a41e21a_net.c_43_NEW.vul	2020-05-20 08:48:18.152954311 -0400
@@ -3,10 +3,15 @@
                                 NetPacketSent *sent_cb)
 {
     NetQueue *queue;
+    size_t size = iov_size(iov, iovcnt);
     int ret;
 
+    if (size > NET_BUFSIZE) {
+        return size;
+    }
+
     if (sender->link_down || !sender->peer) {
-        return iov_size(iov, iovcnt);
+        return size;
     }
 
     /* Let filters handle the packet first */
