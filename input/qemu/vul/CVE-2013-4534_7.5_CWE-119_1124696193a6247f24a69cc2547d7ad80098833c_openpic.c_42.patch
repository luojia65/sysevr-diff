--- CVE-2013-4534_7.5_CWE-119_1124696193a6247f24a69cc2547d7ad80098833c_openpic.c_42_OLD.vul	2020-05-20 08:38:41.906393525 -0400
+++ CVE-2013-4534_7.5_CWE-119_1124696193a6247f24a69cc2547d7ad80098833c_openpic.c_42_NEW.vul	2020-05-20 08:38:41.906393525 -0400
@@ -34,6 +34,13 @@
         {NULL}
     };
 
+    if (opp->nb_cpus > MAX_CPU) {
+        error_set(errp, QERR_PROPERTY_VALUE_OUT_OF_RANGE,
+                  TYPE_OPENPIC, "nb_cpus", (uint64_t)opp->nb_cpus,
+                  (uint64_t)0, (uint64_t)MAX_CPU);
+        return;
+    }
+
     switch (opp->model) {
     case OPENPIC_MODEL_FSL_MPIC_20:
     default:
