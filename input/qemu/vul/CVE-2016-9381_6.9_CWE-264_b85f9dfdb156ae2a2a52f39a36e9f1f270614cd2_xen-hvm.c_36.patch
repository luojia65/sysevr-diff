--- CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_36_OLD.vul	2020-05-20 08:33:34.109278547 -0400
+++ CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_36_NEW.vul	2020-05-20 08:33:34.109278547 -0400
@@ -5,6 +5,10 @@
     trace_cpu_ioreq_move(req, req->dir, req->df, req->data_is_ptr, req->addr,
                          req->data, req->count, req->size);
 
+    if (req->size > sizeof(req->data)) {
+        hw_error("MMIO: bad size (%u)", req->size);
+    }
+
     if (!req->data_is_ptr) {
         if (req->dir == IOREQ_READ) {
             for (i = 0; i < req->count; i++) {
