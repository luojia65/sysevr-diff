--- CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_15_OLD.vul	2020-05-20 08:44:37.177177403 -0400
+++ CVE-2008-0928_4.7_CWE-264_902b27d0b8d5bfa840eaf389d7cbcc28b57e3fbe_block.c_15_NEW.vul	2020-05-20 08:44:37.177177403 -0400
@@ -8,6 +8,10 @@
     bs->read_only = 0;
     bs->is_temporary = 0;
     bs->encrypted = 0;
+    bs->autogrow = 0;
+
+    if (flags & BDRV_O_AUTOGROW)
+        bs->autogrow = 1;
 
     if (flags & BDRV_O_SNAPSHOT) {
         BlockDriverState *bs1;
@@ -52,6 +56,7 @@
     }
     bs->drv = drv;
     bs->opaque = qemu_mallocz(drv->instance_size);
+    bs->total_sectors = 0; /* driver will set if it does not do getlength */
     if (bs->opaque == NULL && drv->instance_size > 0)
         return -1;
     /* Note: for compatibility, we open disk image files as RDWR, and
