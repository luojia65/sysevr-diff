--- CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_35_OLD.vul	2020-05-20 08:33:34.101278774 -0400
+++ CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_35_NEW.vul	2020-05-20 08:33:34.101278774 -0400
@@ -5,6 +5,10 @@
     trace_cpu_ioreq_pio(req, req->dir, req->df, req->data_is_ptr, req->addr,
                          req->data, req->count, req->size);
 
+    if (req->size > sizeof(uint32_t)) {
+        hw_error("PIO: bad size (%u)", req->size);
+    }
+
     if (req->dir == IOREQ_READ) {
         if (!req->data_is_ptr) {
             req->data = do_inp(req->addr, req->size);
