--- CVE-2014-0144_0.0_CWE-000_4854971ac1bbc95c41f6c99c8482903c2ef8d1bb_curl.c_4_OLD.vul	2020-05-20 08:35:53.256609861 -0400
+++ CVE-2014-0144_0.0_CWE-000_4854971ac1bbc95c41f6c99c8482903c2ef8d1bb_curl.c_4_NEW.vul	2020-05-20 08:35:53.256609861 -0400
@@ -9,6 +9,11 @@
     if (!s || !s->orig_buf)
         goto read_end;
 
+    if (s->buf_off >= s->buf_len) {
+        /* buffer full, read nothing */
+        return 0;
+    }
+    realsize = MIN(realsize, s->buf_len - s->buf_off);
     memcpy(s->orig_buf + s->buf_off, ptr, realsize);
     s->buf_off += realsize;
 
