--- CVE-2018-17963_7.5_CWE-190_25c01bd19d0e4b66f357618aeefda1ef7a41e21a_net.c_42_OLD.vul	2020-05-20 08:48:18.160954013 -0400
+++ CVE-2018-17963_7.5_CWE-190_25c01bd19d0e4b66f357618aeefda1ef7a41e21a_net.c_42_NEW.vul	2020-05-20 08:48:18.160954013 -0400
@@ -1,19 +1,15 @@
-ssize_t qemu_deliver_packet_iov(NetClientState *sender,
-                                unsigned flags,
-                                const struct iovec *iov,
-                                int iovcnt,
-                                void *opaque)
+static ssize_t qemu_deliver_packet_iov(NetClientState *sender,
+                                       unsigned flags,
+                                       const struct iovec *iov,
+                                       int iovcnt,
+                                       void *opaque)
 {
     NetClientState *nc = opaque;
-    size_t size = iov_size(iov, iovcnt);
     int ret;
 
-    if (size > INT_MAX) {
-        return size;
-    }
 
     if (nc->link_down) {
-        return size;
+        return iov_size(iov, iovcnt);
     }
 
     if (nc->receive_disabled) {
