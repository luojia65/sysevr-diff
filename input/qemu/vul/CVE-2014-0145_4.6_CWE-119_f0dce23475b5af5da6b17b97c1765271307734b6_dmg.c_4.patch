--- CVE-2014-0145_4.6_CWE-119_f0dce23475b5af5da6b17b97c1765271307734b6_dmg.c_4_OLD.vul	2020-05-20 08:32:58.526238795 -0400
+++ CVE-2014-0145_4.6_CWE-119_f0dce23475b5af5da6b17b97c1765271307734b6_dmg.c_4_NEW.vul	2020-05-20 08:32:58.530238659 -0400
@@ -143,12 +143,8 @@
                     goto fail;
                 }
 
-                if (s->lengths[i] > max_compressed_size) {
-                    max_compressed_size = s->lengths[i];
-                }
-                if (s->sectorcounts[i] > max_sectors_per_chunk) {
-                    max_sectors_per_chunk = s->sectorcounts[i];
-                }
+                update_max_chunk_size(s, i, &max_compressed_size,
+                                      &max_sectors_per_chunk);
             }
             s->n_chunks += chunk_count;
         }
