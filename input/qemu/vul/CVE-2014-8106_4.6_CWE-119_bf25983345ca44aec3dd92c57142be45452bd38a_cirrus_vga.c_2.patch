--- CVE-2014-8106_4.6_CWE-119_bf25983345ca44aec3dd92c57142be45452bd38a_cirrus_vga.c_2_OLD.vul	2020-05-20 08:33:13.793818321 -0400
+++ CVE-2014-8106_4.6_CWE-119_bf25983345ca44aec3dd92c57142be45452bd38a_cirrus_vga.c_2_NEW.vul	2020-05-20 08:33:13.793818321 -0400
@@ -4,6 +4,10 @@
     assert(s->cirrus_blt_width > 0);
     assert(s->cirrus_blt_height > 0);
 
+    if (s->cirrus_blt_width > CIRRUS_BLTBUFSIZE) {
+        return true;
+    }
+
     if (blit_region_is_unsafe(s, s->cirrus_blt_dstpitch,
                               s->cirrus_blt_dstaddr & s->cirrus_addr_mask)) {
         return true;
