--- CVE-2014-3471_2.1_CWE-416_554f802da3f8b09b16b9a84ad5847b2eb0e9ad2b_pcie.c_15_OLD.vul	2020-05-20 08:39:06.505479571 -0400
+++ CVE-2014-3471_2.1_CWE-416_554f802da3f8b09b16b9a84ad5847b2eb0e9ad2b_pcie.c_15_NEW.vul	2020-05-20 08:39:06.505479571 -0400
@@ -5,8 +5,5 @@
 
     pcie_cap_slot_hotplug_common(PCI_DEVICE(hotplug_dev), dev, &exp_cap, errp);
 
-    object_unparent(OBJECT(dev));
-    pci_word_test_and_clear_mask(exp_cap + PCI_EXP_SLTSTA,
-                                 PCI_EXP_SLTSTA_PDS);
-    pcie_cap_slot_event(PCI_DEVICE(hotplug_dev), PCI_EXP_HP_EV_PDC);
+    pcie_cap_slot_push_attention_button(PCI_DEVICE(hotplug_dev));
 }
