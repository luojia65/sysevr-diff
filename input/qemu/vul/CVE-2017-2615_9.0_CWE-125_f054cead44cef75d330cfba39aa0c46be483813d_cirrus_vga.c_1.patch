--- CVE-2017-2615_9.0_CWE-125_f054cead44cef75d330cfba39aa0c46be483813d_cirrus_vga.c_1_OLD.vul	2020-05-20 08:47:19.955120000 -0400
+++ CVE-2017-2615_9.0_CWE-125_f054cead44cef75d330cfba39aa0c46be483813d_cirrus_vga.c_1_NEW.vul	2020-05-20 08:47:19.955120000 -0400
@@ -6,10 +6,9 @@
     }
     if (pitch < 0) {
         int64_t min = addr
-            + ((int64_t)s->cirrus_blt_height-1) * pitch;
-        int32_t max = addr
-            + s->cirrus_blt_width;
-        if (min < 0 || max > s->vga.vram_size) {
+            + ((int64_t)s->cirrus_blt_height - 1) * pitch
+            - s->cirrus_blt_width;
+        if (min < -1 || addr >= s->vga.vram_size) {
             return true;
         }
     } else {
