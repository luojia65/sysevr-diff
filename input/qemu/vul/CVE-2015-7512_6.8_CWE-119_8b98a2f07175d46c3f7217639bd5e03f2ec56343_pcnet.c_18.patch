--- CVE-2015-7512_6.8_CWE-119_8b98a2f07175d46c3f7217639bd5e03f2ec56343_pcnet.c_18_OLD.vul	2020-05-20 08:33:40.753088275 -0400
+++ CVE-2015-7512_6.8_CWE-119_8b98a2f07175d46c3f7217639bd5e03f2ec56343_pcnet.c_18_NEW.vul	2020-05-20 08:33:40.753088275 -0400
@@ -66,6 +66,12 @@
             int pktcount = 0;
 
             if (!s->looptest) {
+                if (size > 4092) {
+#ifdef PCNET_DEBUG_RMD
+                    fprintf(stderr, "pcnet: truncates rx packet.\n");
+#endif
+                    size = 4092;
+                }
                 memcpy(src, buf, size);
                 /* no need to compute the CRC */
                 src[size] = 0;
