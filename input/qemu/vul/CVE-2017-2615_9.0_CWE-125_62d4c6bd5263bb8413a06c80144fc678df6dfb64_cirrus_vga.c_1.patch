--- CVE-2017-2615_9.0_CWE-125_62d4c6bd5263bb8413a06c80144fc678df6dfb64_cirrus_vga.c_1_OLD.vul	2020-05-20 08:43:00.888760503 -0400
+++ CVE-2017-2615_9.0_CWE-125_62d4c6bd5263bb8413a06c80144fc678df6dfb64_cirrus_vga.c_1_NEW.vul	2020-05-20 08:43:00.888760503 -0400
@@ -3,10 +3,9 @@
 {
     if (pitch < 0) {
         int64_t min = addr
-            + ((int64_t)s->cirrus_blt_height-1) * pitch;
-        int32_t max = addr
-            + s->cirrus_blt_width;
-        if (min < 0 || max > s->vga.vram_size) {
+            + ((int64_t)s->cirrus_blt_height - 1) * pitch
+            - s->cirrus_blt_width;
+        if (min < -1 || addr >= s->vga.vram_size) {
             return true;
         }
     } else {
