--- CVE-2014-7815_5.0_CWE-264_e6908bfe8e07f2b452e78e677da1b45b1c0f6829_vnc.c_89_OLD.vul	2020-05-20 08:39:39.172265181 -0400
+++ CVE-2014-7815_5.0_CWE-264_e6908bfe8e07f2b452e78e677da1b45b1c0f6829_vnc.c_89_NEW.vul	2020-05-20 08:39:39.176265033 -0400
@@ -9,6 +9,16 @@
         return;
     }
 
+    switch (bits_per_pixel) {
+    case 8:
+    case 16:
+    case 32:
+        break;
+    default:
+        vnc_client_error(vs);
+        return;
+    }
+
     vs->client_pf.rmax = red_max;
     vs->client_pf.rbits = hweight_long(red_max);
     vs->client_pf.rshift = red_shift;
