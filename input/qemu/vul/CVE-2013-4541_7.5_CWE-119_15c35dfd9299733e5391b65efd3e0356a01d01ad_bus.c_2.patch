--- CVE-2013-4541_7.5_CWE-119_15c35dfd9299733e5391b65efd3e0356a01d01ad_bus.c_2_OLD.vul	2020-05-20 08:39:20.360964571 -0400
+++ CVE-2013-4541_7.5_CWE-119_15c35dfd9299733e5391b65efd3e0356a01d01ad_bus.c_2_NEW.vul	2020-05-20 08:39:20.360964571 -0400
@@ -7,7 +7,9 @@
     } else {
         dev->attached = 1;
     }
-    if (dev->setup_index >= sizeof(dev->data_buf) ||
+    if (dev->setup_index < 0 ||
+        dev->setup_len < 0 ||
+        dev->setup_index >= sizeof(dev->data_buf) ||
         dev->setup_len >= sizeof(dev->data_buf)) {
         return -EINVAL;
     }
