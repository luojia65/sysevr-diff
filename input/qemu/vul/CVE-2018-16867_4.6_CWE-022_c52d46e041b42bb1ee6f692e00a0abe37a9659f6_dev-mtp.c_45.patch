--- CVE-2018-16867_4.6_CWE-022_c52d46e041b42bb1ee6f692e00a0abe37a9659f6_dev-mtp.c_45_OLD.vul	2020-05-20 08:43:43.367179796 -0400
+++ CVE-2018-16867_4.6_CWE-022_c52d46e041b42bb1ee6f692e00a0abe37a9659f6_dev-mtp.c_45_NEW.vul	2020-05-20 08:43:43.367179796 -0400
@@ -12,6 +12,12 @@
 
     filename = utf16_to_str(dataset->length, dataset->filename);
 
+    if (strchr(filename, '/')) {
+        usb_mtp_queue_result(s, RES_PARAMETER_NOT_SUPPORTED, d->trans,
+                             0, 0, 0, 0);
+        return;
+    }
+
     o = usb_mtp_object_lookup_name(p, filename, dataset->length);
     if (o != NULL) {
         next_handle = o->handle;
