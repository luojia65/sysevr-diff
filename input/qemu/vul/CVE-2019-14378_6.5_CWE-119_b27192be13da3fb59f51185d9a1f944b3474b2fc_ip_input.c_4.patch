--- CVE-2019-14378_6.5_CWE-119_b27192be13da3fb59f51185d9a1f944b3474b2fc_ip_input.c_4_OLD.vul	2020-05-20 08:46:27.205082967 -0400
+++ CVE-2019-14378_6.5_CWE-119_b27192be13da3fb59f51185d9a1f944b3474b2fc_ip_input.c_4_NEW.vul	2020-05-20 08:46:27.205082967 -0400
@@ -71,6 +71,7 @@
 	 */
 	while (q != (struct ipasfrag*)&fp->frag_link &&
             ip->ip_off + ip->ip_len > q->ipf_off) {
+        struct ipasfrag *prev;
 		i = (ip->ip_off + ip->ip_len) - q->ipf_off;
 		if (i < q->ipf_len) {
 			q->ipf_len -= i;
@@ -78,9 +79,10 @@
 			m_adj(dtom(slirp, q), i);
 			break;
 		}
+        prev = q;
 		q = q->ipf_next;
-		m_free(dtom(slirp, q->ipf_prev));
-		ip_deq(q->ipf_prev);
+		ip_deq(prev);
+		m_free(dtom(slirp, prev));
 	}
 
 insert:
