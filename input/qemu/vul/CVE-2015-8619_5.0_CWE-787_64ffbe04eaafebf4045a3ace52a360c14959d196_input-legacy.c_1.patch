--- CVE-2015-8619_5.0_CWE-787_64ffbe04eaafebf4045a3ace52a360c14959d196_input-legacy.c_1_OLD.vul	2020-05-20 08:39:54.535693860 -0400
+++ CVE-2015-8619_5.0_CWE-787_64ffbe04eaafebf4045a3ace52a360c14959d196_input-legacy.c_1_NEW.vul	2020-05-20 08:39:54.535693860 -0400
@@ -1,9 +1,10 @@
-int index_from_key(const char *key)
+int index_from_key(const char *key, size_t key_length)
 {
     int i;
 
     for (i = 0; QKeyCode_lookup[i] != NULL; i++) {
-        if (!strcmp(key, QKeyCode_lookup[i])) {
+        if (!strncmp(key, QKeyCode_lookup[i], key_length) &&
+            !QKeyCode_lookup[i][key_length]) {
             break;
         }
     }
