--- CVE-2014-0144_0.0_CWE-000_5dab2faddc8eaa1fb1abdbe2f502001fc13a1b21_qcow2-refcount.c_1_OLD.vul	2020-05-20 08:41:11.520830041 -0400
+++ CVE-2014-0144_0.0_CWE-000_5dab2faddc8eaa1fb1abdbe2f502001fc13a1b21_qcow2-refcount.c_1_NEW.vul	2020-05-20 08:41:11.520830041 -0400
@@ -1,8 +1,10 @@
 int qcow2_refcount_init(BlockDriverState *bs)
 {
     BDRVQcowState *s = bs->opaque;
-    int ret, refcount_table_size2, i;
+    unsigned int refcount_table_size2, i;
+    int ret;
 
+    assert(s->refcount_table_size <= INT_MAX / sizeof(uint64_t));
     refcount_table_size2 = s->refcount_table_size * sizeof(uint64_t);
     s->refcount_table = g_malloc(refcount_table_size2);
     if (s->refcount_table_size > 0) {
