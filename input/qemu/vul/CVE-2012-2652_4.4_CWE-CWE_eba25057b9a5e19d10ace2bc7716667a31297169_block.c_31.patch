--- CVE-2012-2652_4.4_CWE-CWE_eba25057b9a5e19d10ace2bc7716667a31297169_block.c_31_OLD.vul	2020-05-20 08:46:45.540400657 -0400
+++ CVE-2012-2652_4.4_CWE-CWE_eba25057b9a5e19d10ace2bc7716667a31297169_block.c_31_NEW.vul	2020-05-20 08:46:45.540400657 -0400
@@ -29,7 +29,10 @@
 
         bdrv_delete(bs1);
 
-        get_tmp_filename(tmp_filename, sizeof(tmp_filename));
+        ret = get_tmp_filename(tmp_filename, sizeof(tmp_filename));
+        if (ret < 0) {
+            return ret;
+        }
 
         /* Real path is meaningless for protocols */
         if (is_protocol)
