--- CVE-2007-1320_7.2_CWE-119_b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef_cirrus_vga.c_9_OLD.vul	2020-05-20 08:34:04.268373060 -0400
+++ CVE-2007-1320_7.2_CWE-119_b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef_cirrus_vga.c_9_NEW.vul	2020-05-20 08:34:04.268373060 -0400
@@ -8,7 +8,7 @@
 
     for (y = 0; y < lines; y++) {
 	off_cur = off_begin;
-	off_cur_end = off_cur + bytesperline;
+	off_cur_end = (off_cur + bytesperline) & s->cirrus_addr_mask;
 	off_cur &= TARGET_PAGE_MASK;
 	while (off_cur < off_cur_end) {
 	    cpu_physical_memory_set_dirty(s->vram_offset + off_cur);
