--- CVE-2016-4454_3.2_CWE-119_3141be668fa508f08d76de576c381692bccd99ad_vmware_vga.c_8_OLD.vul	2020-05-20 08:34:12.776101183 -0400
+++ CVE-2016-4454_3.2_CWE-119_3141be668fa508f08d76de576c381692bccd99ad_vmware_vga.c_8_NEW.vul	2020-05-20 08:34:12.776101183 -0400
@@ -13,7 +13,10 @@
     if (CMD(min) < (uint8_t *) s->cmd->fifo - (uint8_t *) s->fifo) {
         return 0;
     }
-    if (CMD(max) > SVGA_FIFO_SIZE) {
+    if (CMD(max) > SVGA_FIFO_SIZE ||
+        CMD(min) >= SVGA_FIFO_SIZE ||
+        CMD(stop) >= SVGA_FIFO_SIZE ||
+        CMD(next_cmd) >= SVGA_FIFO_SIZE) {
         return 0;
     }
     if (CMD(max) < CMD(min) + 10 * 1024) {
