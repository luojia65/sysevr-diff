--- CVE-2014-0142_2.1_CWE-369_5e71dfad763d67bb64be79e20e93411c0c30ad25_vpc.c_3_OLD.vul	2020-05-20 08:43:03.268671944 -0400
+++ CVE-2014-0142_2.1_CWE-369_5e71dfad763d67bb64be79e20e93411c0c30ad25_vpc.c_3_NEW.vul	2020-05-20 08:43:03.268671944 -0400
@@ -86,6 +86,11 @@
         }
 
         s->block_size = be32_to_cpu(dyndisk_header->block_size);
+        if (!is_power_of_2(s->block_size) || s->block_size < BDRV_SECTOR_SIZE) {
+            error_setg(errp, "Invalid block size %" PRIu32, s->block_size);
+            ret = -EINVAL;
+            goto fail;
+        }
         s->bitmap_size = ((s->block_size / (8 * 512)) + 511) & ~511;
 
         s->max_table_entries = be32_to_cpu(dyndisk_header->max_table_entries);
