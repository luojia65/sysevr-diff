--- CVE-2016-3710_7.2_CWE-284_4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b_vga.c_1_OLD.vul	2020-05-20 08:38:15.059390209 -0400
+++ CVE-2016-3710_7.2_CWE-284_4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b_vga.c_1_NEW.vul	2020-05-20 08:38:15.063390061 -0400
@@ -35,6 +35,7 @@
             size = 0x8000;
             break;
         }
+        assert(offset + size <= s->vram_size);
         memory_region_init_alias(&s->chain4_alias, memory_region_owner(&s->vram),
                                  "vga.chain4", &s->vram, offset, size);
         memory_region_add_subregion_overlap(s->legacy_address_space, base,
