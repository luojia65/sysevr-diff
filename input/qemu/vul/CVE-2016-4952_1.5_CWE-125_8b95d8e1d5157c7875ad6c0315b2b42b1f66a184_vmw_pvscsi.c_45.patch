--- CVE-2016-4952_1.5_CWE-125_8b95d8e1d5157c7875ad6c0315b2b42b1f66a184_vmw_pvscsi.c_45_OLD.vul	2020-05-20 08:37:15.825583868 -0400
+++ CVE-2016-4952_1.5_CWE-125_8b95d8e1d5157c7875ad6c0315b2b42b1f66a184_vmw_pvscsi.c_45_NEW.vul	2020-05-20 08:37:15.825583868 -0400
@@ -11,7 +11,9 @@
     }
 
     if (s->rings_info_valid) {
-        pvscsi_ring_init_msg(&s->rings, rc);
+        if (pvscsi_ring_init_msg(&s->rings, rc) < 0) {
+            return PVSCSI_COMMAND_PROCESSING_FAILED;
+        }
         s->msg_ring_info_valid = TRUE;
     }
     return sizeof(PVSCSICmdDescSetupMsgRing) / sizeof(uint32_t);
