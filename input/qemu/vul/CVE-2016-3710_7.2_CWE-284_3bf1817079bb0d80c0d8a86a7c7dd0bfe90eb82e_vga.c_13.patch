--- CVE-2016-3710_7.2_CWE-284_3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e_vga.c_13_OLD.vul	2020-05-20 08:48:21.448831661 -0400
+++ CVE-2016-3710_7.2_CWE-284_3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e_vga.c_13_NEW.vul	2020-05-20 08:48:21.448831661 -0400
@@ -26,11 +26,7 @@
             vbe_fixup_regs(s);
             break;
         case VBE_DISPI_INDEX_BANK:
-            if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4) {
-              val &= (s->vbe_bank_mask >> 2);
-            } else {
-              val &= s->vbe_bank_mask;
-            }
+            val &= s->vbe_bank_mask;
             s->vbe_regs[s->vbe_index] = val;
             s->bank_offset = (val << 16);
             vga_update_memory_access(s);
