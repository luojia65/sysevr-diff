--- CVE-2014-0145_4.6_CWE-119_c05e4667be91b46ab42b5a11babf8e84d476cc6b_qcow2-snapshot.c_11_OLD.vul	2020-05-20 08:37:51.772253744 -0400
+++ CVE-2014-0145_4.6_CWE-119_c05e4667be91b46ab42b5a11babf8e84d476cc6b_qcow2-snapshot.c_11_NEW.vul	2020-05-20 08:37:51.772253744 -0400
@@ -22,7 +22,7 @@
     sn = &s->snapshots[snapshot_index];
 
     /* Allocate and read in the snapshot's L1 table */
-    new_l1_bytes = s->l1_size * sizeof(uint64_t);
+    new_l1_bytes = sn->l1_size * sizeof(uint64_t);
     new_l1_table = g_malloc0(align_offset(new_l1_bytes, 512));
 
     ret = bdrv_pread(bs->file, sn->l1_table_offset, new_l1_table, new_l1_bytes);
