--- CVE-2018-18849_2.1_CWE-125_bd6dd4eaa6f7fe0c4d797d4e59803d295313b7a7_lsi53c895a.c_37_OLD.vul	2020-05-20 08:45:27.827292582 -0400
+++ CVE-2018-18849_2.1_CWE-125_bd6dd4eaa6f7fe0c4d797d4e59803d295313b7a7_lsi53c895a.c_37_NEW.vul	2020-05-20 08:45:27.827292582 -0400
@@ -187,8 +187,10 @@
         break;
     case 0x58: /* SBDL */
         /* Some drivers peek at the data bus during the MSG IN phase.  */
-        if ((s->sstat1 & PHASE_MASK) == PHASE_MI)
+        if ((s->sstat1 & PHASE_MASK) == PHASE_MI) {
+            assert(s->msg_len > 0);
             return s->msg[0];
+        }
         ret = 0;
         break;
     case 0x59: /* SBDL high */
