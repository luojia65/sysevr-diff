--- CVE-2018-16872_3.5_CWE-020_6b29db871d1262c79d87b9a6ae3c84b1f013fb76_dev-mtp.c_44_OLD.vul	2020-05-20 08:41:38.075842005 -0400
+++ CVE-2018-16872_3.5_CWE-020_6b29db871d1262c79d87b9a6ae3c84b1f013fb76_dev-mtp.c_44_NEW.vul	2020-05-20 08:41:38.075842005 -0400
@@ -26,7 +26,7 @@
                                  0, 0, 0, 0);
             goto done;
         }
-        d->fd = open(path, O_CREAT | O_WRONLY, mask);
+        d->fd = open(path, O_CREAT | O_WRONLY | O_CLOEXEC | O_NOFOLLOW, mask);
         if (d->fd == -1) {
             usb_mtp_queue_result(s, RES_STORE_FULL, d->trans,
                                  0, 0, 0, 0);
