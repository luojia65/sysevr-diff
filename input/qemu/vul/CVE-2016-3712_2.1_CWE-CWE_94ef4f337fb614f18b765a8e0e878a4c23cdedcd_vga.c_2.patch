--- CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_2_OLD.vul	2020-05-20 08:31:57.711658497 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_2_NEW.vul	2020-05-20 08:31:57.711658497 -0400
@@ -12,8 +12,8 @@
         s->has_chain4_alias = false;
         s->plane_updated = 0xf;
     }
-    if ((s->sr[VGA_SEQ_PLANE_WRITE] & VGA_SR02_ALL_PLANES) ==
-        VGA_SR02_ALL_PLANES && s->sr[VGA_SEQ_MEMORY_MODE] & VGA_SR04_CHN_4M) {
+    if ((sr(s, VGA_SEQ_PLANE_WRITE) & VGA_SR02_ALL_PLANES) ==
+        VGA_SR02_ALL_PLANES && sr(s, VGA_SEQ_MEMORY_MODE) & VGA_SR04_CHN_4M) {
         offset = 0;
         switch ((s->gr[VGA_GFX_MISC] >> 2) & 3) {
         case 0:
