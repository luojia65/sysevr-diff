--- CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_4_OLD.vul	2020-05-20 08:31:57.739658402 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_4_NEW.vul	2020-05-20 08:31:57.739658402 -0400
@@ -32,7 +32,7 @@
           ((s->cr[VGA_CRTC_OVERFLOW] >> 6) & 2)) << 8);
     vretr_end_line = s->cr[VGA_CRTC_V_SYNC_END] & 0xf;
 
-    clocking_mode = (s->sr[VGA_SEQ_CLOCK_MODE] >> 3) & 1;
+    clocking_mode = (sr(s, VGA_SEQ_CLOCK_MODE) >> 3) & 1;
     clock_sel = (s->msr >> 2) & 3;
     dots = (s->msr & 1) ? 8 : 9;
 
