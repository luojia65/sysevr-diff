--- CVE-2015-5165_5.0_CWE-200_c6296ea88df040054ccd781f3945fe103f8c7c17_rtl8139.c_55_OLD.vul	2020-05-20 08:49:22.938543455 -0400
+++ CVE-2015-5165_5.0_CWE-200_c6296ea88df040054ccd781f3945fe103f8c7c17_rtl8139.c_55_NEW.vul	2020-05-20 08:49:22.938543455 -0400
@@ -235,7 +235,12 @@
             }
 
             ip_protocol = ip->ip_p;
-            ip_data_len = be16_to_cpu(ip->ip_len) - hlen;
+
+            ip_data_len = be16_to_cpu(ip->ip_len);
+            if (ip_data_len < hlen || ip_data_len > eth_payload_len) {
+                goto skip_offload;
+            }
+            ip_data_len -= hlen;
 
             if (txdw0 & CP_TX_IPCS)
             {
