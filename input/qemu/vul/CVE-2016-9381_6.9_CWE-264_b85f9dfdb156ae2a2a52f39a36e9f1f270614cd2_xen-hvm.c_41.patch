--- CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_41_OLD.vul	2020-05-20 08:33:34.093278999 -0400
+++ CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_41_NEW.vul	2020-05-20 08:33:34.093278999 -0400
@@ -33,11 +33,13 @@
         req.df = 1;
         req.type = buf_req->type;
         req.data_is_ptr = 0;
+        xen_rmb();
         qw = (req.size == 8);
         if (qw) {
             buf_req = &buf_page->buf_ioreq[(rdptr + 1) %
                                            IOREQ_BUFFER_SLOT_NUM];
             req.data |= ((uint64_t)buf_req->data) << 32;
+            xen_rmb();
         }
 
         handle_ioreq(state, &req);
