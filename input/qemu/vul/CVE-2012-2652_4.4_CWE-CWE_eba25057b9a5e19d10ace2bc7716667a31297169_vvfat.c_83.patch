--- CVE-2012-2652_4.4_CWE-CWE_eba25057b9a5e19d10ace2bc7716667a31297169_vvfat.c_83_OLD.vul	2020-05-20 08:46:48.792279647 -0400
+++ CVE-2012-2652_4.4_CWE-CWE_eba25057b9a5e19d10ace2bc7716667a31297169_vvfat.c_83_NEW.vul	2020-05-20 08:46:48.792279647 -0400
@@ -9,7 +9,12 @@
     array_init(&(s->commits), sizeof(commit_t));
 
     s->qcow_filename = g_malloc(1024);
-    get_tmp_filename(s->qcow_filename, 1024);
+    ret = get_tmp_filename(s->qcow_filename, 1024);
+    if (ret < 0) {
+        g_free(s->qcow_filename);
+        s->qcow_filename = NULL;
+        return ret;
+    }
 
     bdrv_qcow = bdrv_find_format("qcow");
     options = parse_option_parameters("", bdrv_qcow->create_options, NULL);
