--- CVE-2013-4150_7.5_CWE-119_b24cfb0f1ef056263210cd6e80444a1113cea24a_virtio-net.c_48_OLD.vul	2020-05-20 08:37:13.037686829 -0400
+++ CVE-2013-4150_7.5_CWE-119_b24cfb0f1ef056263210cd6e80444a1113cea24a_virtio-net.c_48_NEW.vul	2020-05-20 08:37:13.037686829 -0400
@@ -81,6 +81,11 @@
         }
 
         n->curr_queues = qemu_get_be16(f);
+        if (n->curr_queues > n->max_queues) {
+            error_report("virtio-net: curr_queues %x > max_queues %x",
+                         n->curr_queues, n->max_queues);
+            return -1;
+        }
         for (i = 1; i < n->curr_queues; i++) {
             n->vqs[i].tx_waiting = qemu_get_be32(f);
         }
