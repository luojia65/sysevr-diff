--- CVE-2017-15124_7.8_CWE-020_ada8d2e4369ea49677d8672ac81bce73eefd5b54_vnc-jobs.c_8_OLD.vul	2020-05-20 08:36:51.326487329 -0400
+++ CVE-2017-15124_7.8_CWE-020_ada8d2e4369ea49677d8672ac81bce73eefd5b54_vnc-jobs.c_8_NEW.vul	2020-05-20 08:36:51.326487329 -0400
@@ -12,6 +12,11 @@
                 vs->ioc, G_IO_IN | G_IO_OUT, vnc_client_io, vs, NULL);
         }
         buffer_move(&vs->output, &vs->jobs_buffer);
+
+        if (vs->job_update == VNC_STATE_UPDATE_FORCE) {
+            vs->force_update_offset = vs->output.offset;
+        }
+        vs->job_update = VNC_STATE_UPDATE_NONE;
     }
     flush = vs->ioc != NULL && vs->abort != true;
     vnc_unlock_output(vs);
