--- CVE-2011-2212_7.4_CWE-119_c8eac1cfa1e9104a658b4614ada758861b8d823a_virtio.c_28_OLD.vul	2020-05-20 08:33:08.117955706 -0400
+++ CVE-2011-2212_7.4_CWE-119_c8eac1cfa1e9104a658b4614ada758861b8d823a_virtio.c_28_NEW.vul	2020-05-20 08:33:08.117955706 -0400
@@ -33,9 +33,17 @@
         struct iovec *sg;
 
         if (vring_desc_flags(desc_pa, i) & VRING_DESC_F_WRITE) {
+            if (elem->in_num >= ARRAY_SIZE(elem->in_sg)) {
+                error_report("Too many write descriptors in indirect table");
+                exit(1);
+            }
             elem->in_addr[elem->in_num] = vring_desc_addr(desc_pa, i);
             sg = &elem->in_sg[elem->in_num++];
         } else {
+            if (elem->out_num >= ARRAY_SIZE(elem->out_sg)) {
+                error_report("Too many read descriptors in indirect table");
+                exit(1);
+            }
             elem->out_addr[elem->out_num] = vring_desc_addr(desc_pa, i);
             sg = &elem->out_sg[elem->out_num++];
         }
