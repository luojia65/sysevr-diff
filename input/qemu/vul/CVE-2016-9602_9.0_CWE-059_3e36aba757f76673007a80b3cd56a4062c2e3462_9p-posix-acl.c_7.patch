--- CVE-2016-9602_9.0_CWE-059_3e36aba757f76673007a80b3cd56a4062c2e3462_9p-posix-acl.c_7_OLD.vul	2020-05-20 08:37:45.956469213 -0400
+++ CVE-2016-9602_9.0_CWE-059_3e36aba757f76673007a80b3cd56a4062c2e3462_9p-posix-acl.c_7_NEW.vul	2020-05-20 08:37:45.960469064 -0400
@@ -1,11 +1,6 @@
 static int mp_dacl_setxattr(FsContext *ctx, const char *path, const char *name,
                             void *value, size_t size, int flags)
 {
-    char *buffer;
-    int ret;
-
-    buffer = rpath(ctx, path);
-    ret = lsetxattr(buffer, MAP_ACL_DEFAULT, value, size, flags);
-    g_free(buffer);
-    return ret;
+    return local_setxattr_nofollow(ctx, path, MAP_ACL_DEFAULT, value, size,
+                                   flags);
 }
