--- CVE-2013-4541_7.5_CWE-119_c4bd2e4cb0550fd83321029b9ae7582073fcac67_bus.c_2_OLD.vul	2020-05-20 08:45:15.139764717 -0400
+++ CVE-2013-4541_7.5_CWE-119_c4bd2e4cb0550fd83321029b9ae7582073fcac67_bus.c_2_NEW.vul	2020-05-20 08:45:15.139764717 -0400
@@ -7,7 +7,9 @@
     } else {
         dev->attached = 1;
     }
-    if (dev->setup_index >= sizeof(dev->data_buf) ||
+    if (dev->setup_index < 0 ||
+        dev->setup_len < 0 ||
+        dev->setup_index >= sizeof(dev->data_buf) ||
         dev->setup_len >= sizeof(dev->data_buf)) {
         return -EINVAL;
     }
