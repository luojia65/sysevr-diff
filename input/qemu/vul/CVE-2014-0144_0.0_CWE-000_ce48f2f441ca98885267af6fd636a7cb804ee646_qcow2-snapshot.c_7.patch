--- CVE-2014-0144_0.0_CWE-000_ce48f2f441ca98885267af6fd636a7cb804ee646_qcow2-snapshot.c_7_OLD.vul	2020-05-20 08:44:53.096585000 -0400
+++ CVE-2014-0144_0.0_CWE-000_ce48f2f441ca98885267af6fd636a7cb804ee646_qcow2-snapshot.c_7_NEW.vul	2020-05-20 08:44:53.096585000 -0400
@@ -8,6 +8,10 @@
     uint64_t *l1_table = NULL;
     int64_t l1_table_offset;
 
+    if (s->nb_snapshots >= QCOW_MAX_SNAPSHOTS) {
+        return -EFBIG;
+    }
+
     memset(sn, 0, sizeof(*sn));
 
     /* Generate an ID if it wasn't passed */
