--- CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_23_OLD.vul	2020-05-20 08:31:57.703658524 -0400
+++ CVE-2016-3712_2.1_CWE-CWE_94ef4f337fb614f18b765a8e0e878a4c23cdedcd_vga.c_23_NEW.vul	2020-05-20 08:31:57.703658524 -0400
@@ -12,7 +12,7 @@
     int64_t now = qemu_clock_get_ms(QEMU_CLOCK_VIRTUAL);
 
     /* compute font data address (in plane 2) */
-    v = s->sr[VGA_SEQ_CHARACTER_MAP];
+    v = sr(s, VGA_SEQ_CHARACTER_MAP);
     offset = (((v >> 4) & 1) | ((v << 1) & 6)) * 8192 * 4 + 2;
     if (offset != s->font_offsets[0]) {
         s->font_offsets[0] = offset;
