--- CVE-2015-5154_7.2_CWE-119_d2ff85854512574e7209f295e87b0835d5b032c6_core.c_77_OLD.vul	2020-05-20 08:33:04.886030884 -0400
+++ CVE-2015-5154_7.2_CWE-119_d2ff85854512574e7209f295e87b0835d5b032c6_core.c_77_NEW.vul	2020-05-20 08:33:04.886030884 -0400
@@ -11,6 +11,10 @@
     }
 
     p = s->data_ptr;
+    if (p + 4 > s->data_end) {
+        return;
+    }
+
     *(uint32_t *)p = le32_to_cpu(val);
     p += 4;
     s->data_ptr = p;
