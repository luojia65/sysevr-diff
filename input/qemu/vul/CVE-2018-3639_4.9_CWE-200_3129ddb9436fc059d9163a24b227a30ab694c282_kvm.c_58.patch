--- CVE-2018-3639_4.9_CWE-200_3129ddb9436fc059d9163a24b227a30ab694c282_kvm.c_58_OLD.vul	2020-05-20 08:39:33.248485440 -0400
+++ CVE-2018-3639_4.9_CWE-200_3129ddb9436fc059d9163a24b227a30ab694c282_kvm.c_58_NEW.vul	2020-05-20 08:39:33.248485440 -0400
@@ -47,8 +47,9 @@
     if (has_msr_spec_ctrl) {
         kvm_msr_entry_add(cpu, MSR_IA32_SPEC_CTRL, 0);
     }
-
-
+    if (has_msr_virt_ssbd) {
+        kvm_msr_entry_add(cpu, MSR_VIRT_SSBD, 0);
+    }
     if (!env->tsc_valid) {
         kvm_msr_entry_add(cpu, MSR_IA32_TSC, 0);
         env->tsc_valid = !runstate_is_running();
@@ -414,6 +415,9 @@
         case MSR_IA32_SPEC_CTRL:
             env->spec_ctrl = msrs[i].data;
             break;
+        case MSR_VIRT_SSBD:
+            env->virt_ssbd = msrs[i].data;
+            break;
         case MSR_IA32_RTIT_CTL:
             env->msr_rtit_ctrl = msrs[i].data;
             break;
