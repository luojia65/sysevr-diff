--- CVE-2013-4541_7.5_CWE-119_9f8e9895c504149d7048e9fc5eb5cbb34b16e49a_bus.c_2_OLD.vul	2020-05-20 08:49:19.314678320 -0400
+++ CVE-2013-4541_7.5_CWE-119_9f8e9895c504149d7048e9fc5eb5cbb34b16e49a_bus.c_2_NEW.vul	2020-05-20 08:49:19.314678320 -0400
@@ -7,7 +7,9 @@
     } else {
         dev->attached = 1;
     }
-    if (dev->setup_index >= sizeof(dev->data_buf) ||
+    if (dev->setup_index < 0 ||
+        dev->setup_len < 0 ||
+        dev->setup_index >= sizeof(dev->data_buf) ||
         dev->setup_len >= sizeof(dev->data_buf)) {
         return -EINVAL;
     }
