--- CVE-2016-3710_7.2_CWE-284_3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e_vga.c_1_OLD.vul	2020-05-20 08:48:21.444831809 -0400
+++ CVE-2016-3710_7.2_CWE-284_3bf1817079bb0d80c0d8a86a7c7dd0bfe90eb82e_vga.c_1_NEW.vul	2020-05-20 08:48:21.444831809 -0400
@@ -35,6 +35,7 @@
             size = 0x8000;
             break;
         }
+        assert(offset + size <= s->vram_size);
         memory_region_init_alias(&s->chain4_alias, memory_region_owner(&s->vram),
                                  "vga.chain4", &s->vram, offset, size);
         memory_region_add_subregion_overlap(s->legacy_address_space, base,
