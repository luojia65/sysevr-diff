--- CVE-2015-5154_7.2_CWE-119_9634e45e0b2bd4906778efdfb4b38b6fa042ebec_core.c_78_OLD.vul	2020-05-20 08:39:30.252596831 -0400
+++ CVE-2015-5154_7.2_CWE-119_9634e45e0b2bd4906778efdfb4b38b6fa042ebec_core.c_78_NEW.vul	2020-05-20 08:39:30.252596831 -0400
@@ -12,6 +12,10 @@
     }
 
     p = s->data_ptr;
+    if (p + 4 > s->data_end) {
+        return 0;
+    }
+
     ret = cpu_to_le32(*(uint32_t *)p);
     p += 4;
     s->data_ptr = p;
