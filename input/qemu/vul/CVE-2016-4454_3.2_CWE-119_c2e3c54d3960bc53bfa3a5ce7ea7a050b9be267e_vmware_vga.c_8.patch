--- CVE-2016-4454_3.2_CWE-119_c2e3c54d3960bc53bfa3a5ce7ea7a050b9be267e_vmware_vga.c_8_OLD.vul	2020-05-20 08:52:35.139391145 -0400
+++ CVE-2016-4454_3.2_CWE-119_c2e3c54d3960bc53bfa3a5ce7ea7a050b9be267e_vmware_vga.c_8_NEW.vul	2020-05-20 08:52:35.139391145 -0400
@@ -13,7 +13,10 @@
     if (CMD(min) < (uint8_t *) s->cmd->fifo - (uint8_t *) s->fifo) {
         return 0;
     }
-    if (CMD(max) > SVGA_FIFO_SIZE) {
+    if (CMD(max) > SVGA_FIFO_SIZE ||
+        CMD(min) >= SVGA_FIFO_SIZE ||
+        CMD(stop) >= SVGA_FIFO_SIZE ||
+        CMD(next_cmd) >= SVGA_FIFO_SIZE) {
         return 0;
     }
     if (CMD(max) < CMD(min) + 10 * 1024) {
