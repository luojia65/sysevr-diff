--- CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_43_OLD.vul	2020-05-20 08:33:34.117278321 -0400
+++ CVE-2016-9381_6.9_CWE-264_b85f9dfdb156ae2a2a52f39a36e9f1f270614cd2_xen-hvm.c_43_NEW.vul	2020-05-20 08:33:34.117278321 -0400
@@ -5,7 +5,11 @@
 
     handle_buffered_iopage(state);
     if (req) {
-        handle_ioreq(state, req);
+        ioreq_t copy = *req;
+
+        xen_rmb();
+        handle_ioreq(state, &copy);
+        req->data = copy.data;
 
         if (req->state != STATE_IOREQ_INPROCESS) {
             fprintf(stderr, "Badness in I/O request ... not in service?!: "
