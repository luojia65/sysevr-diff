--- CVE-2015-5279_7.2_CWE-119_7aa2bcad0ca837dd6d4bf4fa38a80314b4a6b755_ne2000.c_6_OLD.vul	2020-05-20 08:37:54.368157541 -0400
+++ CVE-2015-5279_7.2_CWE-119_7aa2bcad0ca837dd6d4bf4fa38a80314b4a6b755_ne2000.c_6_NEW.vul	2020-05-20 08:37:54.368157541 -0400
@@ -40,13 +40,19 @@
         offset = addr | (page << 4);
         switch(offset) {
         case EN0_STARTPG:
-            s->start = val << 8;
+            if (val << 8 <= NE2000_PMEM_END) {
+                s->start = val << 8;
+            }
             break;
         case EN0_STOPPG:
-            s->stop = val << 8;
+            if (val << 8 <= NE2000_PMEM_END) {
+                s->stop = val << 8;
+            }
             break;
         case EN0_BOUNDARY:
-            s->boundary = val;
+            if (val << 8 < NE2000_PMEM_END) {
+                s->boundary = val;
+            }
             break;
         case EN0_IMR:
             s->imr = val;
@@ -87,7 +93,9 @@
             s->phys[offset - EN1_PHYS] = val;
             break;
         case EN1_CURPAG:
-            s->curpag = val;
+            if (val << 8 < NE2000_PMEM_END) {
+                s->curpag = val;
+            }
             break;
         case EN1_MULT ... EN1_MULT + 7:
             s->mult[offset - EN1_MULT] = val;
