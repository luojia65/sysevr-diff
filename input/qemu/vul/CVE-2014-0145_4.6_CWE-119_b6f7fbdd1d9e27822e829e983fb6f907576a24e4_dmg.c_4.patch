--- CVE-2014-0145_4.6_CWE-119_b6f7fbdd1d9e27822e829e983fb6f907576a24e4_dmg.c_4_OLD.vul	2020-05-20 08:33:56.680610151 -0400
+++ CVE-2014-0145_4.6_CWE-119_b6f7fbdd1d9e27822e829e983fb6f907576a24e4_dmg.c_4_NEW.vul	2020-05-20 08:33:56.680610151 -0400
@@ -143,12 +143,8 @@
                     goto fail;
                 }
 
-                if (s->lengths[i] > max_compressed_size) {
-                    max_compressed_size = s->lengths[i];
-                }
-                if (s->sectorcounts[i] > max_sectors_per_chunk) {
-                    max_sectors_per_chunk = s->sectorcounts[i];
-                }
+                update_max_chunk_size(s, i, &max_compressed_size,
+                                      &max_sectors_per_chunk);
             }
             s->n_chunks += chunk_count;
         }
