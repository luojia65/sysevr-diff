--- CVE-2014-7815_5.0_CWE-264_b2f1d90530301d7915dddc8a750063757675b21a_vnc.c_89_OLD.vul	2020-05-20 08:49:48.597588611 -0400
+++ CVE-2014-7815_5.0_CWE-264_b2f1d90530301d7915dddc8a750063757675b21a_vnc.c_89_NEW.vul	2020-05-20 08:49:48.597588611 -0400
@@ -9,6 +9,16 @@
         return;
     }
 
+    switch (bits_per_pixel) {
+    case 8:
+    case 16:
+    case 32:
+        break;
+    default:
+        vnc_client_error(vs);
+        return;
+    }
+
     vs->client_pf.rmax = red_max;
     vs->client_pf.rbits = hweight_long(red_max);
     vs->client_pf.rshift = red_shift;
