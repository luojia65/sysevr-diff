--- CVE-2018-7550_4.6_CWE-125_84cfae0b6f232c8ac8aaa37ead01ed49c5d32dfd_vga.c_32_OLD.vul	2020-05-20 08:42:23.674145298 -0400
+++ CVE-2018-7550_4.6_CWE-125_84cfae0b6f232c8ac8aaa37ead01ed49c5d32dfd_vga.c_32_NEW.vul	2020-05-20 08:42:23.674145298 -0400
@@ -24,6 +24,8 @@
 
     region_start = (s->start_addr * 4);
     region_end = region_start + (ram_addr_t)s->line_offset * height;
+    region_end += width * s->get_bpp(s) / 8; /* scanline length */
+    region_end -= s->line_offset;
     if (region_end > s->vbe_size) {
         /* wraps around (can happen with cirrus vbe modes) */
         region_start = 0;
