--- CVE-2014-0142_2.1_CWE-369_9302e863aa8baa5d932fc078967050c055fa1a7f_parallels.c_2_OLD.vul	2020-05-20 08:35:55.744519742 -0400
+++ CVE-2014-0142_2.1_CWE-369_9302e863aa8baa5d932fc078967050c055fa1a7f_parallels.c_2_NEW.vul	2020-05-20 08:35:55.744519742 -0400
@@ -23,6 +23,11 @@
     bs->total_sectors = le32_to_cpu(ph.nb_sectors);
 
     s->tracks = le32_to_cpu(ph.tracks);
+    if (s->tracks == 0) {
+        error_setg(errp, "Invalid image: Zero sectors per track");
+        ret = -EINVAL;
+        goto fail;
+    }
 
     s->catalog_size = le32_to_cpu(ph.catalog_entries);
     if (s->catalog_size > INT_MAX / 4) {
