--- CVE-2018-15746_2.1_CWE-358_9ad3314fa32a555c880344b960702af85ad6a231_qemu-seccomp.c_1_OLD.vul	2020-05-20 08:49:25.862434652 -0400
+++ CVE-2018-15746_2.1_CWE-358_9ad3314fa32a555c880344b960702af85ad6a231_qemu-seccomp.c_1_NEW.vul	2020-05-20 08:49:25.862434652 -0400
@@ -3,6 +3,7 @@
     int rc = 0;
     unsigned int i = 0;
     scmp_filter_ctx ctx;
+    uint32_t action = qemu_seccomp_get_kill_action();
 
     ctx = seccomp_init(SCMP_ACT_ALLOW);
     if (ctx == NULL) {
@@ -15,7 +16,7 @@
             continue;
         }
 
-        rc = seccomp_rule_add_array(ctx, SCMP_ACT_TRAP, blacklist[i].num,
+        rc = seccomp_rule_add_array(ctx, action, blacklist[i].num,
                                     blacklist[i].narg, blacklist[i].arg_cmp);
         if (rc < 0) {
             goto seccomp_return;
