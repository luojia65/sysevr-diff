--- CVE-2013-4534_7.5_CWE-119_73d963c0a75cb99c6aaa3f6f25e427aa0b35a02e_openpic.c_42_OLD.vul	2020-05-20 08:52:52.442747221 -0400
+++ CVE-2013-4534_7.5_CWE-119_73d963c0a75cb99c6aaa3f6f25e427aa0b35a02e_openpic.c_42_NEW.vul	2020-05-20 08:52:52.442747221 -0400
@@ -34,6 +34,13 @@
         {NULL}
     };
 
+    if (opp->nb_cpus > MAX_CPU) {
+        error_set(errp, QERR_PROPERTY_VALUE_OUT_OF_RANGE,
+                  TYPE_OPENPIC, "nb_cpus", (uint64_t)opp->nb_cpus,
+                  (uint64_t)0, (uint64_t)MAX_CPU);
+        return;
+    }
+
     switch (opp->model) {
     case OPENPIC_MODEL_FSL_MPIC_20:
     default:
