--- CVE-2015-7504_4.6_CWE-119_837f21aacf5a714c23ddaadbbc5212f9b661e3f7_pcnet.c_20_OLD.vul	2020-05-20 08:38:28.462892736 -0400
+++ CVE-2015-7504_4.6_CWE-119_837f21aacf5a714c23ddaadbbc5212f9b661e3f7_pcnet.c_20_NEW.vul	2020-05-20 08:38:28.466892588 -0400
@@ -46,8 +46,10 @@
         bcnt = 4096 - GET_FIELD(tmd.length, TMDL, BCNT);
 
         /* if multi-tmd packet outsizes s->buffer then skip it silently.
-           Note: this is not what real hw does */
-        if (s->xmit_pos + bcnt > sizeof(s->buffer)) {
+         * Note: this is not what real hw does.
+         * Last four bytes of s->buffer are used to store CRC FCS code.
+         */
+        if (s->xmit_pos + bcnt > sizeof(s->buffer) - 4) {
             s->xmit_pos = -1;
             goto txdone;
         }
