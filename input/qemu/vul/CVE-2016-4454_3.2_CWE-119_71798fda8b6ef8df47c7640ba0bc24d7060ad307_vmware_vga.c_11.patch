--- CVE-2016-4454_3.2_CWE-119_71798fda8b6ef8df47c7640ba0bc24d7060ad307_vmware_vga.c_11_OLD.vul	2020-05-20 08:51:04.706756377 -0400
+++ CVE-2016-4454_3.2_CWE-119_71798fda8b6ef8df47c7640ba0bc24d7060ad307_vmware_vga.c_11_NEW.vul	2020-05-20 08:51:04.706756377 -0400
@@ -9,7 +9,7 @@
     len = vmsvga_fifo_length(s);
     while (len > 0) {
         /* May need to go back to the start of the command if incomplete */
-        cmd_start = s->cmd->stop;
+        cmd_start = s->fifo_stop;
 
         switch (cmd = vmsvga_fifo_read(s)) {
         case SVGA_CMD_UPDATE:
@@ -168,7 +168,8 @@
             break;
 
         rewind:
-            s->cmd->stop = cmd_start;
+            s->fifo_stop = cmd_start;
+            s->fifo[SVGA_FIFO_STOP] = cpu_to_le32(s->fifo_stop);
             break;
         }
     }
