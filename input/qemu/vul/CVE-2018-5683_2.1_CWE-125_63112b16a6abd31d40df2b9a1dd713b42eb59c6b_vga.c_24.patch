--- CVE-2018-5683_2.1_CWE-125_63112b16a6abd31d40df2b9a1dd713b42eb59c6b_vga.c_24_OLD.vul	2020-05-20 08:32:18.991375753 -0400
+++ CVE-2018-5683_2.1_CWE-125_63112b16a6abd31d40df2b9a1dd713b42eb59c6b_vga.c_24_NEW.vul	2020-05-20 08:32:18.991375753 -0400
@@ -104,6 +104,9 @@
         cx_min = width;
         cx_max = -1;
         for(cx = 0; cx < width; cx++) {
+            if (src + sizeof(uint16_t) > s->vram_ptr + s->vram_size) {
+                break;
+            }
             ch_attr = *(uint16_t *)src;
             if (full_update || ch_attr != *ch_attr_ptr || src == cursor_ptr) {
                 if (cx < cx_min)
