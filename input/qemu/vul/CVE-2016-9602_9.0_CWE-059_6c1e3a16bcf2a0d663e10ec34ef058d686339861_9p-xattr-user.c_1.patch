--- CVE-2016-9602_9.0_CWE-059_6c1e3a16bcf2a0d663e10ec34ef058d686339861_9p-xattr-user.c_1_OLD.vul	2020-05-20 08:40:04.951306484 -0400
+++ CVE-2016-9602_9.0_CWE-059_6c1e3a16bcf2a0d663e10ec34ef058d686339861_9p-xattr-user.c_1_NEW.vul	2020-05-20 08:40:04.955306337 -0400
@@ -1,9 +1,6 @@
 static ssize_t mp_user_getxattr(FsContext *ctx, const char *path,
                                 const char *name, void *value, size_t size)
 {
-    char *buffer;
-    ssize_t ret;
-
     if (strncmp(name, "user.virtfs.", 12) == 0) {
         /*
          * Don't allow fetch of user.virtfs namesapce
@@ -12,8 +9,5 @@
         errno = ENOATTR;
         return -1;
     }
-    buffer = rpath(ctx, path);
-    ret = lgetxattr(buffer, name, value, size);
-    g_free(buffer);
-    return ret;
+    return local_getxattr_nofollow(ctx, path, name, value, size);
 }
