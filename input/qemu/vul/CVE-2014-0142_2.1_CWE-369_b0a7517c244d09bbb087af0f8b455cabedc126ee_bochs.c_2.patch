--- CVE-2014-0142_2.1_CWE-369_b0a7517c244d09bbb087af0f8b455cabedc126ee_bochs.c_2_OLD.vul	2020-05-20 08:41:09.012923351 -0400
+++ CVE-2014-0142_2.1_CWE-369_b0a7517c244d09bbb087af0f8b455cabedc126ee_bochs.c_2_NEW.vul	2020-05-20 08:41:09.012923351 -0400
@@ -52,6 +52,14 @@
     s->extent_blocks = 1 + (le32_to_cpu(bochs.extent) - 1) / 512;
 
     s->extent_size = le32_to_cpu(bochs.extent);
+    if (s->extent_size == 0) {
+        error_setg(errp, "Extent size may not be zero");
+        return -EINVAL;
+    } else if (s->extent_size > 0x800000) {
+        error_setg(errp, "Extent size %" PRIu32 " is too large",
+                   s->extent_size);
+        return -EINVAL;
+    }
 
     if (s->catalog_size < bs->total_sectors / s->extent_size) {
         error_setg(errp, "Catalog size is too small for this disk size");
