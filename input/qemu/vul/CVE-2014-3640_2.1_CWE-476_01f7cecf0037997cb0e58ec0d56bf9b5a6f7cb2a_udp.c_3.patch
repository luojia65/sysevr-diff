--- CVE-2014-3640_2.1_CWE-476_01f7cecf0037997cb0e58ec0d56bf9b5a6f7cb2a_udp.c_3_OLD.vul	2020-05-20 08:47:43.694236610 -0400
+++ CVE-2014-3640_2.1_CWE-476_01f7cecf0037997cb0e58ec0d56bf9b5a6f7cb2a_udp.c_3_NEW.vul	2020-05-20 08:47:43.698236461 -0400
@@ -89,7 +89,7 @@
 	 * Locate pcb for datagram.
 	 */
 	so = slirp->udp_last_so;
-	if (so->so_lport != uh->uh_sport ||
+	if (so == &slirp->udb || so->so_lport != uh->uh_sport ||
 	    so->so_laddr.s_addr != ip->ip_src.s_addr) {
 		struct socket *tmp;
 
