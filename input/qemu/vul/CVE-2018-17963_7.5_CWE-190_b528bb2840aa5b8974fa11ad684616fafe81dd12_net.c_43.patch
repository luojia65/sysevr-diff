--- CVE-2018-17963_7.5_CWE-190_b528bb2840aa5b8974fa11ad684616fafe81dd12_net.c_43_OLD.vul	2020-05-20 08:48:40.548120924 -0400
+++ CVE-2018-17963_7.5_CWE-190_b528bb2840aa5b8974fa11ad684616fafe81dd12_net.c_43_NEW.vul	2020-05-20 08:48:40.548120924 -0400
@@ -3,10 +3,15 @@
                                 NetPacketSent *sent_cb)
 {
     NetQueue *queue;
+    size_t size = iov_size(iov, iovcnt);
     int ret;
 
+    if (size > NET_BUFSIZE) {
+        return size;
+    }
+
     if (sender->link_down || !sender->peer) {
-        return iov_size(iov, iovcnt);
+        return size;
     }
 
     /* Let filters handle the packet first */
