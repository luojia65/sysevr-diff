--- CVE-2019-6778_4.6_CWE-119_345fab6ffe57b0bf6dccbc0844f45f77b91d9de0_tcp_subr.c_13_OLD.vul	2020-05-20 08:49:43.545776602 -0400
+++ CVE-2019-6778_4.6_CWE-119_345fab6ffe57b0bf6dccbc0844f45f77b91d9de0_tcp_subr.c_13_NEW.vul	2020-05-20 08:49:43.545776602 -0400
@@ -26,6 +26,11 @@
 			socklen_t addrlen = sizeof(struct sockaddr_in);
 			struct sbuf *so_rcv = &so->so_rcv;
 
+			if (m->m_len > so_rcv->sb_datalen
+					- (so_rcv->sb_wptr - so_rcv->sb_data)) {
+			    return 1;
+			}
+
 			memcpy(so_rcv->sb_wptr, m->m_data, m->m_len);
 			so_rcv->sb_wptr += m->m_len;
 			so_rcv->sb_rptr += m->m_len;
