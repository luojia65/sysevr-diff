--- CVE-2014-0144_0.0_CWE-000_6d4b9e55fc625514a38d27cff4b9933f617fa7dc_curl.c_4_OLD.vul	2020-05-20 08:47:10.303479159 -0400
+++ CVE-2014-0144_0.0_CWE-000_6d4b9e55fc625514a38d27cff4b9933f617fa7dc_curl.c_4_NEW.vul	2020-05-20 08:47:10.303479159 -0400
@@ -9,6 +9,11 @@
     if (!s || !s->orig_buf)
         goto read_end;
 
+    if (s->buf_off >= s->buf_len) {
+        /* buffer full, read nothing */
+        return 0;
+    }
+    realsize = MIN(realsize, s->buf_len - s->buf_off);
     memcpy(s->orig_buf + s->buf_off, ptr, realsize);
     s->buf_off += realsize;
 
