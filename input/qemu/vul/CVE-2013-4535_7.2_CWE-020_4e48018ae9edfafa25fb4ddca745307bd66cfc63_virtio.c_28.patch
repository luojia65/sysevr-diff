--- CVE-2013-4535_7.2_CWE-020_4e48018ae9edfafa25fb4ddca745307bd66cfc63_virtio.c_28_OLD.vul	2020-05-20 08:37:21.401377844 -0400
+++ CVE-2013-4535_7.2_CWE-020_4e48018ae9edfafa25fb4ddca745307bd66cfc63_virtio.c_28_NEW.vul	2020-05-20 08:37:21.401377844 -0400
@@ -4,6 +4,12 @@
     unsigned int i;
     hwaddr len;
 
+    if (num_sg >= VIRTQUEUE_MAX_SIZE) {
+        error_report("virtio: map attempt out of bounds: %zd > %d",
+                     num_sg, VIRTQUEUE_MAX_SIZE);
+        exit(1);
+    }
+
     for (i = 0; i < num_sg; i++) {
         len = sg[i].iov_len;
         sg[i].iov_base = cpu_physical_memory_map(addr[i], &len, is_write);
