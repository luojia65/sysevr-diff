--- CVE-2014-0143_4.4_CWE-190_8f4754ede56e3f9ea3fd7207f4a7c4453e59285b_block.c_85_OLD.vul	2020-05-20 08:34:51.390806352 -0400
+++ CVE-2014-0143_4.4_CWE-190_8f4754ede56e3f9ea3fd7207f4a7c4453e59285b_block.c_85_NEW.vul	2020-05-20 08:34:51.390806352 -0400
@@ -1,6 +1,10 @@
 static int bdrv_check_request(BlockDriverState *bs, int64_t sector_num,
                               int nb_sectors)
 {
+    if (nb_sectors > INT_MAX / BDRV_SECTOR_SIZE) {
+        return -EIO;
+    }
+
     return bdrv_check_byte_request(bs, sector_num * BDRV_SECTOR_SIZE,
                                    nb_sectors * BDRV_SECTOR_SIZE);
 }
