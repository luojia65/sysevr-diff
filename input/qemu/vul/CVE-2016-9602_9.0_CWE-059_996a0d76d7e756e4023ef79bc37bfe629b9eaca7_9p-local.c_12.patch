--- CVE-2016-9602_9.0_CWE-059_996a0d76d7e756e4023ef79bc37bfe629b9eaca7_9p-local.c_12_OLD.vul	2020-05-20 08:37:30.169053639 -0400
+++ CVE-2016-9602_9.0_CWE-059_996a0d76d7e756e4023ef79bc37bfe629b9eaca7_9p-local.c_12_NEW.vul	2020-05-20 08:37:30.169053639 -0400
@@ -1,13 +1,9 @@
 static int local_open(FsContext *ctx, V9fsPath *fs_path,
                       int flags, V9fsFidOpenState *fs)
 {
-    char *buffer;
-    char *path = fs_path->data;
     int fd;
 
-    buffer = rpath(ctx, path);
-    fd = open(buffer, flags | O_NOFOLLOW);
-    g_free(buffer);
+    fd = local_open_nofollow(ctx, fs_path->data, flags, 0);
     if (fd == -1) {
         return -1;
     }
