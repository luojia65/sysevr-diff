--- CVE-2017-8379_4.9_CWE-772_f8d050a20a40113a6b6945fa364b655a6a327ac8_input.c_22_OLD.vul	2020-05-20 08:48:24.724709756 -0400
+++ CVE-2017-8379_4.9_CWE-772_f8d050a20a40113a6b6945fa364b655a6a327ac8_input.c_22_NEW.vul	2020-05-20 08:48:24.724709756 -0400
@@ -4,6 +4,8 @@
         kbd_timer = timer_new_ms(QEMU_CLOCK_VIRTUAL, qemu_input_queue_process,
                                  &kbd_queue);
     }
-    qemu_input_queue_delay(&kbd_queue, kbd_timer,
-                           delay_ms ? delay_ms : kbd_default_delay_ms);
+    if (queue_count < queue_limit) {
+        qemu_input_queue_delay(&kbd_queue, kbd_timer,
+                               delay_ms ? delay_ms : kbd_default_delay_ms);
+    }
 }
