--- CVE-2016-3710_7.2_CWE-284_4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b_vga.c_13_OLD.vul	2020-05-20 08:38:15.059390209 -0400
+++ CVE-2016-3710_7.2_CWE-284_4f0323d26c8da08b7bcfdd4722a38711bd2f1a3b_vga.c_13_NEW.vul	2020-05-20 08:38:15.059390209 -0400
@@ -26,11 +26,7 @@
             vbe_fixup_regs(s);
             break;
         case VBE_DISPI_INDEX_BANK:
-            if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4) {
-              val &= (s->vbe_bank_mask >> 2);
-            } else {
-              val &= s->vbe_bank_mask;
-            }
+            val &= s->vbe_bank_mask;
             s->vbe_regs[s->vbe_index] = val;
             s->bank_offset = (val << 16);
             vga_update_memory_access(s);
