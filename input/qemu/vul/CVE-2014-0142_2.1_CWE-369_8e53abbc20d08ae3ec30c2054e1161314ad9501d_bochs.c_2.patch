--- CVE-2014-0142_2.1_CWE-369_8e53abbc20d08ae3ec30c2054e1161314ad9501d_bochs.c_2_OLD.vul	2020-05-20 08:49:59.545181221 -0400
+++ CVE-2014-0142_2.1_CWE-369_8e53abbc20d08ae3ec30c2054e1161314ad9501d_bochs.c_2_NEW.vul	2020-05-20 08:49:59.545181221 -0400
@@ -53,6 +53,14 @@
     s->extent_blocks = 1 + (le32_to_cpu(bochs.extent) - 1) / 512;
 
     s->extent_size = le32_to_cpu(bochs.extent);
+    if (s->extent_size == 0) {
+        error_setg(errp, "Extent size may not be zero");
+        return -EINVAL;
+    } else if (s->extent_size > 0x800000) {
+        error_setg(errp, "Extent size %" PRIu32 " is too large",
+                   s->extent_size);
+        return -EINVAL;
+    }
 
     if (s->catalog_size < bs->total_sectors / s->extent_size) {
         error_setg(errp, "Catalog size is too small for this disk size");
